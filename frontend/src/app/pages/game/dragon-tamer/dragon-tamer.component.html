<div class="wrapper-main">
  <app-navigation-bar currentLocation="dragon-tamer"></app-navigation-bar>

  <div class="wrapper-content">

    <div class="wrapper-actions-section">
      <div class="wrapper-lore">
        <div class="wrapper-lore-img">
          <img src="assets/img/lore/dragon-tamer.png" draggable="false" alt="Goblin thinkerer">
        </div>
        {{ 'dragonTamer.dragonTamerHint' | translate }}
      </div>

      <div *ngIf="actionsLoading" class="mt-5">
        <app-loading-indicator></app-loading-indicator>
      </div>
      <div *ngIf="!actionsLoading && (dragons$ | async) as dragons" class="wrapper-actions">

        <div *ngFor="let action of actions; let actionInd = index" class="item-action">
          <div class="action-hint">
            {{ action.hint | translate }}
          </div>

          <select #dragonSelect (change)="0" class="input-select">
            <option value=""></option>
            <option class="input-select-option" *ngFor="let dragon of dragons; let dragonInd = index" [value]="dragonInd">
              {{ dragon.name }} [{{ dragon.level }}]
            </option>
          </select>

          <div *ngIf="action.uid === 'tamer-action-1'">
            <div class="label">New name:</div>
            <input #nameInput class="input-text" placeholder="{{ 'auctions.name' | translate }}"/>
          </div>

          <div *ngIf="action.uid === 'tamer-action-4'">
            <div class="label">New nature:</div>
            <select #newNatureSelect class="input-select">
              <option value=""></option>
              <option *ngFor="let nature of dragonNature;" [value]="nature.value">{{ nature.name | translate }}</option>
            </select>
          </div>

          <div *ngIf="action.requiredItems && action.requiredItems.length" class="cost-hint">
            {{ 'dragonTamer.requiredItems' | translate }}:
            <div *ngFor="let item of action.requiredItems; let itemInd = index" [class]="'inline' + ' color-' + item.rarity">
              {{ item.name + ' ('+item.quantity+')' + (itemInd+1 < action.requiredItems.length ? ', ' : '') }}
            </div>
          </div>

          <div class="cost-hint">
            {{ 'dragonTamer.actionCost' | translate }}:
            {{ dragonSelect.value != '' ? dragons[+dragonSelect.value].level * action.costFactor : '---' }}
          </div>

          <button (click)="performAction(action, dragons[+dragonSelect.value])" [disabled]="dragonSelect.value == ''" class="btn-base btn-action">
            {{ 'common.confirm' | translate }}
          </button>
        </div>

      </div>

    </div>

  </div>
</div>
