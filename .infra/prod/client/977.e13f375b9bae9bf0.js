"use strict";(self.webpackChunknightwood_frontend=self.webpackChunknightwood_frontend||[]).push([[977],{4977:(Jn,D,s)=>{s.r(D),s.d(D,{GameModule:()=>$n});var c=s(9808),f=s(1264),_=s(3075),l=s(8747),T=s(1758),d=s(2402),y=s(591),e=s(1269),Z=s(3022),q=s(2257),h=s(6621),j=s(253),x=s(208),u=s(821);function G(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",12),e.TgZ(1,"div",13),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).saveAnswer(r)}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.qZA()}if(2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",e.lcZ(3,1,t.label)," ")}}function R(n,a){if(1&n&&(e.TgZ(0,"div",8),e.TgZ(1,"div",9),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",10),e.YNc(5,G,4,3,"div",11),e.qZA(),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,t.question)),e.xp6(3),e.Q6J("ngForOf",t.answers)}}function B(n,a){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,R,6,4,"div",7),e.qZA()),2&n){const t=a.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngIf",t.step===i.currentStep)}}function W(n,a){1&n&&e._UZ(0,"app-input-base",19),2&n&&e.Q6J("options",a.$implicit)}function X(n,a){if(1&n&&(e.TgZ(0,"button",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("disabled",!t.form.valid),e.xp6(1),e.hij(" ",e.lcZ(2,2,"dragon.adopt")," ")}}function z(n,a){1&n&&(e.TgZ(0,"div",21),e._UZ(1,"app-loading-indicator"),e.qZA())}function K(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",14),e.TgZ(1,"form",15),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw().adoptDragon()}),e.TgZ(2,"div",9),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,W,1,1,"app-input-base",16),e.YNc(6,X,3,4,"button",17),e.ALo(7,"async"),e.YNc(8,z,2,0,"div",18),e.ALo(9,"async"),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(2),e.Oqu(e.lcZ(4,5,"dragon.chooseDragonName")),e.xp6(2),e.Q6J("ngForOf",t.fields),e.xp6(1),e.Q6J("ngIf",!e.lcZ(7,7,t.submitLoading$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,9,t.submitLoading$))}}let V=(()=>{class n{constructor(t,i,o,r){this.router=t,this.actionController=i,this.toastService=o,this.validatorService=r,this.adoptStages=[{step:T.K_.Trait,question:"dragon.traitQuestion",answers:[{label:"dragon.fireTrait",points:this.setNaturePoints(90,30,10,40)},{label:"dragon.waterTrait",points:this.setNaturePoints(40,100,30,20)},{label:"dragon.windTrait",points:this.setNaturePoints(20,20,90,5)},{label:"dragon.earthTrait",points:this.setNaturePoints(15,25,10,80)}]},{step:T.K_.Value,question:"dragon.valueQuestion",answers:[{label:"dragon.fireValue",points:this.setNaturePoints(80,60,50,50)},{label:"dragon.waterValue",points:this.setNaturePoints(10,80,50,30)},{label:"dragon.windValue",points:this.setNaturePoints(70,40,90,20)},{label:"dragon.earthValue",points:this.setNaturePoints(30,50,20,70)}]},{step:T.K_.Location,question:"dragon.locationQuestion",answers:[{label:"dragon.fireLocation",points:this.setNaturePoints(60,40,50,50)},{label:"dragon.waterLocation",points:this.setNaturePoints(-10,90,30,40)},{label:"dragon.windLocation",points:this.setNaturePoints(30,10,60,50)},{label:"dragon.earthLocation",points:this.setNaturePoints(40,10,10,60)}]}],this.currentStep=T.K_.Trait,this.chosenAnswers=[],this.form=new _.cw({name:new _.NI(null,[_.kI.required,_.kI.minLength(d.EN),_.kI.maxLength(d.Eh)])}),this.fields=[{form:this.form,key:"name",label:"",type:"text"}],this.submitLoading$=new y.X(!1),this.adoptStep=T.K_}get dragonName(){return this.form.get("name")}ngOnInit(){this.currentStep=T.K_.Trait,this.chosenAnswers=[]}setNaturePoints(t,i,o,r){return[{nature:l.KP.Fire,value:t},{nature:l.KP.Water,value:i},{nature:l.KP.Wind,value:o},{nature:l.KP.Earth,value:r}]}saveAnswer(t){this.currentStep+=1,this.chosenAnswers.push(t)}determineNature(){const t=Object.keys(l.KP).map(o=>({nature:l.KP[o],points:0}));return this.chosenAnswers.forEach(o=>{o.points.forEach(r=>{t.find(p=>p.nature===r.nature).points+=r.value})}),t.sort((o,r)=>o.points-r.points)[t.length-1].nature}validateDragonName(t){return!((t=t.replace(" ","")).length<d.EN||t.length>d.Eh)}adoptDragon(){var t;if(!this.form.valid)return void this.toastService.showError("errors.formInvalid","errors.formInvalidHint");if(!this.validatorService.checkBannedWords(this.dragonName.value))return;if(!this.validateDragonName(this.dragonName.value))return void this.toastService.showError("errors.formInvalid","errors.formInvalidHint");const i={name:this.dragonName.value,nature:this.determineNature()};null===(t=this.submitLoading$)||void 0===t||t.next(!0),this.actionController.adoptDragon(i).subscribe(()=>{var o;null===(o=this.submitLoading$)||void 0===o||o.next(!1),this.toastService.showSuccess("common.success","dragon.adoptSuccess"),this.router.navigate(["game","my-dragons"])},()=>{var o;return null===(o=this.submitLoading$)||void 0===o?void 0:o.next(!1)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.F0),e.Y36(l.iQ),e.Y36(Z.k),e.Y36(q.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-adopt-dragon"]],decls:12,vars:8,consts:[[1,"wrapper-main"],["currentLocation","adopt-dragon"],[1,"wrapper-content"],[1,"title"],[1,"title-secondary"],[4,"ngFor","ngForOf"],["class","wrapper-form",4,"ngIf"],["class","wrapper-stage",4,"ngIf"],[1,"wrapper-stage"],[1,"question"],[1,"answers-wrapper"],["class","answer",4,"ngFor","ngForOf"],[1,"answer"],[3,"click"],[1,"wrapper-form"],[3,"formGroup","ngSubmit"],[3,"options",4,"ngFor","ngForOf"],["class","btn-base",3,"disabled",4,"ngIf"],["class","spinner",4,"ngIf"],[3,"options"],[1,"btn-base",3,"disabled"],[1,"spinner"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div"),e.TgZ(4,"div",3),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",4),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.qZA(),e.YNc(10,B,2,1,"div",5),e.YNc(11,K,10,11,"div",6),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Oqu(e.lcZ(6,4,"dragon.adoptDragonTilte")),e.xp6(3),e.Oqu(e.lcZ(9,6,"dragon.adoptDragonHint")),e.xp6(2),e.Q6J("ngForOf",i.adoptStages),e.xp6(1),e.Q6J("ngIf",i.currentStep===i.adoptStep.Name))},directives:[h.g,c.sg,c.O5,_._Y,_.JL,_.sg,j.r,x.Q],pipes:[u.X$,c.Ov],styles:['.color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.title[_ngcontent-%COMP%]{margin-top:10px;font-size:27px;color:#ffeeca}.title-secondary[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:60px;font-size:21px;color:#ffeeca}.wrapper-stage[_ngcontent-%COMP%]{width:clamp(0px,95%,800px);margin:20px auto;letter-spacing:.5px}.question[_ngcontent-%COMP%]{font-size:16px;font-weight:600}.answers-wrapper[_ngcontent-%COMP%]{width:clamp(0px,100%,600px);margin:20px auto;padding:10px;display:grid;grid-gap:1rem;gap:1rem;grid-template-areas:"a b" "c d";grid-template-rows:repeat(4,40%)}@keyframes answerEntrance{0%{opacity:0;transform:scale(.3);filter:hue-rotate(180deg)}to{opacity:1;transform:scale(1);filter:hue-rotate(0deg)}}.answer[_ngcontent-%COMP%]:nth-child(1){grid-area:"a";animation-delay:.1s;background:linear-gradient(rgba(36,41,54,.5),rgba(36,41,54,.6)),url(/assets/img/adopt-dragon/fire.jpg)}.answer[_ngcontent-%COMP%]:nth-child(1):hover{background:linear-gradient(rgba(36,41,54,.5),rgba(36,41,54,.6)),url(/assets/img/adopt-dragon/fire.jpg)}.answer[_ngcontent-%COMP%]:nth-child(2){grid-area:"b";animation-delay:.2s;background:linear-gradient(rgba(36,41,54,.5),rgba(36,41,54,.6)),url(/assets/img/adopt-dragon/water.jpg)}.answer[_ngcontent-%COMP%]:nth-child(2):hover{background:linear-gradient(rgba(36,41,54,.5),rgba(36,41,54,.6)),url(/assets/img/adopt-dragon/water.jpg)}.answer[_ngcontent-%COMP%]:nth-child(3){grid-area:"c";animation-delay:calc(3 * .1s);background:linear-gradient(rgba(36,41,54,.5),rgba(36,41,54,.6)),url(/assets/img/adopt-dragon/wind.jpg)}.answer[_ngcontent-%COMP%]:nth-child(3):hover{background:linear-gradient(rgba(36,41,54,.5),rgba(36,41,54,.6)),url(/assets/img/adopt-dragon/wind.jpg)}.answer[_ngcontent-%COMP%]:nth-child(4){grid-area:"d";animation-delay:.4s;background:linear-gradient(rgba(36,41,54,.5),rgba(36,41,54,.6)),url(/assets/img/adopt-dragon/earth.jpg)}.answer[_ngcontent-%COMP%]:nth-child(4):hover{background:linear-gradient(rgba(36,41,54,.5),rgba(36,41,54,.6)),url(/assets/img/adopt-dragon/earth.jpg)}.answer[_ngcontent-%COMP%]{color:#ffeeca;text-shadow:2px 2px #242936;cursor:pointer;font-size:16px;font-weight:500;animation:answerEntrance .7s ease-in-out;animation-fill-mode:backwards;border-radius:4px;overflow:hidden;line-height:5;box-shadow:0 0 9px #ffeeca;opacity:.8}.answer[_ngcontent-%COMP%]:hover{opacity:1;transition:opacity 1s ease-in-out!important}'],changeDetection:0}),n})();var A=s(2916),g=s(4850),ee=s(7821),te=s(8323);function ne(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-alchemy-mixtures",12),e.NdJ("refreshItems",function(){return e.CHM(t),e.oxw().refreshMixturesData()}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("userItems$",t.userItems$)("brewedMixtures$",t.brewedMixtures$)("mixtureRecipes$",t.mixtureRecipes$)}}function ie(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-alchemy-boosters",13),e.NdJ("refreshItems",function(){return e.CHM(t),e.oxw().refreshBoosterData()}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("userItems$",t.userItems$)("userDragons$",t.userDragons$)("boosterRecipes$",t.boosterRecipes$)}}let oe=(()=>{class n{constructor(t,i,o){this.alchemyController=t,this.dragonController=i,this.itemController=o,this.displayMixtures=!1,this.displayBoosters=!1,this.boosterRecipes$=new A.y}ngOnInit(){this.getUserItems(),this.getBrewedMixtures(),this.getMixtrueRecipes(),this.getBoosterRecipes(),this.getUserDragons()}getUserItems(){this.userItems$=this.itemController.getOwnedItems().pipe((0,g.U)(t=>t.data))}getBrewedMixtures(){this.brewedMixtures$=this.alchemyController.getOnGoingMixtures({}).pipe((0,g.U)(t=>t.data))}getMixtrueRecipes(){this.mixtureRecipes$=this.alchemyController.getMixtureRecipes()}getBoosterRecipes(){this.boosterRecipes$=this.alchemyController.getBoosterRecipes()}getUserDragons(){this.userDragons$=this.dragonController.getOwned()}refreshMixturesData(){this.getUserItems(),this.getBrewedMixtures()}refreshBoosterData(){this.getUserItems(),this.getUserDragons()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.N),e.Y36(l.GE),e.Y36(l.l3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-alchemy"]],decls:25,vars:14,consts:[[1,"wrapper-main"],["currentLocation","crafting"],[1,"wrapper-content"],[1,"wrapper-alchemy-section"],[1,"wrapper-lore"],[1,"wrapper-lore-img"],["src","assets/img/lore/alchemy-potions.png","draggable","false","alt","Goblin alchemist"],[1,"wrapper-lore-text"],[1,"btn-base","btn-small",3,"click"],[3,"userItems$","brewedMixtures$","mixtureRecipes$","refreshItems",4,"ngIf"],["src","assets/img/lore/alchemy-boosters.png","draggable","false","alt","Goblin alchemist"],[3,"userItems$","userDragons$","boosterRecipes$","refreshItems",4,"ngIf"],[3,"userItems$","brewedMixtures$","mixtureRecipes$","refreshItems"],[3,"userItems$","userDragons$","boosterRecipes$","refreshItems"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e._UZ(6,"img",6),e.qZA(),e.TgZ(7,"div",7),e._uU(8),e.ALo(9,"translate"),e.TgZ(10,"button",8),e.NdJ("click",function(){return i.displayMixtures=!i.displayMixtures}),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.qZA(),e.qZA(),e.YNc(13,ne,1,3,"app-alchemy-mixtures",9),e.qZA(),e.TgZ(14,"div",3),e.TgZ(15,"div",4),e.TgZ(16,"div",5),e._UZ(17,"img",10),e.qZA(),e.TgZ(18,"div",7),e._uU(19),e.ALo(20,"translate"),e.TgZ(21,"button",8),e.NdJ("click",function(){return i.displayBoosters=!i.displayBoosters}),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.qZA(),e.qZA(),e.YNc(24,ie,1,3,"app-alchemy-boosters",11),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(8),e.hij(" ",e.lcZ(9,6,"alchemy.mixturesHint")," "),e.xp6(3),e.hij(" ",e.lcZ(12,8,"alchemy.toggleOffer")," "),e.xp6(2),e.Q6J("ngIf",i.displayMixtures),e.xp6(6),e.hij(" ",e.lcZ(20,10,"alchemy.boostersHint")," "),e.xp6(3),e.hij(" ",e.lcZ(23,12,"alchemy.toggleOffer")," "),e.xp6(2),e.Q6J("ngIf",i.displayBoosters))},directives:[h.g,c.O5,ee.A,te.d],pipes:[u.X$],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-alchemy-section[_ngcontent-%COMP%]{box-shadow:inset 1px 1px 12px 1px #000;background-color:#0000000d;margin:10px auto;max-width:900px;padding:10px}.wrapper-lore[_ngcontent-%COMP%]{display:flex;gap:10px;text-align:left}.wrapper-lore-img[_ngcontent-%COMP%]{min-width:125px;width:125px}.wrapper-lore-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%}.wrapper-lore-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;text-align:justify}.wrapper-lore-text[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px 0}"],changeDetection:0}),n})();var v=s(2868),E=s(194),k=s(8125),$=s(8761);const ae=["searchMinLevel"],re=["searchMaxLevel"];function se(n,a){1&n&&(e.TgZ(0,"div",16),e._UZ(1,"app-loading-indicator"),e.qZA())}function ce(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",21),e.TgZ(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",19),e._uU(4),e.qZA(),e.TgZ(5,"button",22),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).selectBattleDragon(r)}),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.qZA()}if(2&n){const t=a.$implicit;e.xp6(2),e.AsE("",t.name," [",t.level,"]"),e.xp6(2),e.Oqu(t.nature),e.xp6(2),e.hij(" ",e.lcZ(7,4,"arena.battle")," ")}}function le(n,a){if(1&n&&(e.TgZ(0,"div",17),e.TgZ(1,"div",18),e.TgZ(2,"div"),e._uU(3),e.ALo(4,"translate"),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",19),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.qZA(),e.YNc(9,ce,8,6,"div",20),e.qZA()),2&n){const t=a.ngIf;e.xp6(3),e.AsE("",e.lcZ(4,4,"dragon.name")," [",e.lcZ(5,6,"dragon.level"),"]"),e.xp6(4),e.Oqu(e.lcZ(8,8,"dragon.nature")),e.xp6(2),e.Q6J("ngForOf",t)}}function pe(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-dragon-choice-modal",23),e.NdJ("close",function(){return e.CHM(t),e.oxw().displayDragonChoiceModal=!1})("dragonSelected",function(o){return e.CHM(t),e.oxw().startBattle(o)}),e.qZA()}if(2&n){const t=e.oxw(),i=e.MAs(27);e.Q6J("message",t.modalMessage)("dragonTemplate",i)}}function de(n,a){if(1&n&&(e._uU(0),e.TgZ(1,"div",24),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n){const t=a.$implicit;e.AsE(" ",t.name," [",t.level,"] "),e.xp6(2),e.AsE(" ",t.stamina," ",e.lcZ(3,4,"dragon.stamina")," ")}}function ge(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-dragon-battle",25),e.NdJ("updatedDragon",function(o){return e.CHM(t),e.oxw().handleModalClose(o)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("ownedDragon",t.selectedOwnedDragon)("enemyDragon",t.selectedEnemyDragon)}}let J=(()=>{class n{constructor(t,i,o,r){this.router=t,this.dragonController=i,this.dateService=o,this.toastService=r,this.enemyDragonPage=0,this.enemyDragonLimit=12,this.canGetPrev=!1,this.canGetNext=!0,this.displayDragonChoiceModal=!1,this.modalMessage="",this.battleLoading=!1,this.displayBattle=!1}ngOnInit(){this.getEnemyDragons()}validateSearchParams(){var t,i;const o=+(null===(t=this.searchMinLevel)||void 0===t?void 0:t.nativeElement.value);if(o&&(o<d.EY||o>d.ut))return!1;const r=+(null===(i=this.searchMaxLevel)||void 0===i?void 0:i.nativeElement.value);return!(r&&(r<d.EY||r>d.ut)||o&&r&&o>r)}getEnemyDragons(t){var i,o;if(!this.validateSearchParams())return void this.toastService.showError("errors.formInvalid","errors.formInvalidHint");!0===t?this.enemyDragonPage+=1:!1===t?this.enemyDragonPage-=1:this.enemyDragonPage=0,this.enemyDragonPage<0&&(this.enemyDragonPage=0);const r={page:this.enemyDragonPage,limit:this.enemyDragonLimit,minLevel:(null===(i=this.searchMinLevel)||void 0===i?void 0:i.nativeElement.value)?Math.floor(+this.searchMinLevel.nativeElement.value):d.EY,maxLevel:(null===(o=this.searchMaxLevel)||void 0===o?void 0:o.nativeElement.value)?Math.floor(+this.searchMaxLevel.nativeElement.value):d.ut};this.enemyDragons$=this.dragonController.getAll(r).pipe((0,v.b)(p=>{this.canGetPrev=0!==this.enemyDragonPage,this.canGetNext=(this.enemyDragonPage+1)*this.enemyDragonLimit<p.meta.totalItems}),(0,g.U)(p=>p.data))}navigateAdopt(){this.router.navigate(["game","adopt-dragon"])}selectBattleDragon(t){this.selectedEnemyDragon=t,this.displayDragonChoiceModal=!0}startBattle(t){if(this.displayDragonChoiceModal=!1,this.selectedOwnedDragon=t,t&&this.selectedEnemyDragon){if(t.id==this.selectedEnemyDragon.id)return void this.toastService.showError("errors.error","errors.battleItself");if(t.stamina<1)return void this.toastService.showError("errors.error","errors.noStamina");if(t.battledWith.filter(i=>i===this.selectedEnemyDragon.id).length>1)return void this.toastService.showError("errors.error","errors.alreadyBattled");if(!this.dateService.checkIfEventAvailable(t.action.nextAction))return void this.toastService.showError("errors.error","errors.dragonBusy");this.displayBattle=!0}}handleModalClose(t){t&&this.selectedOwnedDragon&&(this.selectedOwnedDragon.stamina=t.stamina),this.displayBattle=!1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.F0),e.Y36(l.GE),e.Y36(E.R),e.Y36(Z.k))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-arena"]],viewQuery:function(t,i){if(1&t&&(e.Gf(ae,5),e.Gf(re,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.searchMinLevel=o.first),e.iGM(o=e.CRH())&&(i.searchMaxLevel=o.first)}},decls:29,vars:23,consts:[[1,"wrapper-main"],["currentLocation","arena"],[1,"wrapper-content"],[1,"wrapper-menu"],["type","number",1,"input-text",3,"placeholder"],["searchMinLevel",""],["searchMaxLevel",""],[1,"btn-base","btn-search",3,"click"],[1,"wrapper-table"],["enemyDragonsLoading",""],["class","wrapper-dragons",4,"ngIf","ngIfElse"],[1,"wrapper-table-btns"],[1,"btn-base","btn-table",3,"disabled","click"],[3,"message","dragonTemplate","close","dragonSelected",4,"ngIf"],["dragonTemplate",""],[3,"ownedDragon","enemyDragon","updatedDragon",4,"ngIf"],[2,"margin","220px auto"],[1,"wrapper-dragons"],[1,"item-dragon","item-dragon-header"],[1,"no-mobile"],["class","item-dragon",4,"ngFor","ngForOf"],[1,"item-dragon"],[1,"btn-base","btn-battle",3,"click"],[3,"message","dragonTemplate","close","dragonSelected"],[1,"label-small"],[3,"ownedDragon","enemyDragon","updatedDragon"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e._UZ(4,"input",4,5),e.ALo(6,"translate"),e._UZ(7,"input",4,6),e.ALo(9,"translate"),e.TgZ(10,"button",7),e.NdJ("click",function(){return i.getEnemyDragons()}),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.qZA(),e.TgZ(13,"div",8),e.YNc(14,se,2,0,"ng-template",null,9,e.W1O),e.YNc(16,le,10,10,"div",10),e.ALo(17,"async"),e.TgZ(18,"div",11),e.TgZ(19,"button",12),e.NdJ("click",function(){return i.getEnemyDragons(!1)}),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"button",12),e.NdJ("click",function(){return i.getEnemyDragons(!0)}),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(25,pe,1,2,"app-dragon-choice-modal",13),e.YNc(26,de,4,6,"ng-template",null,14,e.W1O),e.YNc(28,ge,1,2,"app-dragon-battle",15),e.qZA()),2&t){const o=e.MAs(15);e.xp6(4),e.s9C("placeholder",e.lcZ(6,11,"auctions.minLevel")),e.xp6(3),e.s9C("placeholder",e.lcZ(9,13,"auctions.maxLevel")),e.xp6(4),e.hij(" ",e.lcZ(12,15,"common.search")," "),e.xp6(5),e.Q6J("ngIf",e.lcZ(17,17,i.enemyDragons$))("ngIfElse",o),e.xp6(3),e.Q6J("disabled",!i.canGetPrev),e.xp6(1),e.hij(" ",e.lcZ(21,19,"common.prev")," "),e.xp6(2),e.Q6J("disabled",!i.canGetNext),e.xp6(1),e.hij(" ",e.lcZ(24,21,"common.next")," "),e.xp6(2),e.Q6J("ngIf",i.displayDragonChoiceModal),e.xp6(3),e.Q6J("ngIf",i.displayBattle)}},directives:[h.g,x.Q,c.O5,c.sg,k.q,$._],pipes:[u.X$,c.Ov],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;gap:10px 0px;padding:10px}.wrapper-menu[_ngcontent-%COMP%]{width:100%;max-width:400px;margin:25px auto -15px}.wrapper-menu[_ngcontent-%COMP%]   .input-text[_ngcontent-%COMP%]{width:49%;margin:10px auto 5px}.wrapper-menu[_ngcontent-%COMP%]   .input-text[_ngcontent-%COMP%]:first-of-type{margin-right:1%}.wrapper-menu[_ngcontent-%COMP%]   .input-text[_ngcontent-%COMP%]:last-of-type{margin-left:1%}.wrapper-menu[_ngcontent-%COMP%]   .btn-search[_ngcontent-%COMP%]{width:100%;max-width:100%;height:24px;line-height:22px}.wrapper-table[_ngcontent-%COMP%]{width:100%;max-width:400px;margin:10px auto;justify-content:space-between;align-items:stretch}.wrapper-dragons[_ngcontent-%COMP%]{margin:5px auto 10px;display:flex;gap:1px;flex-direction:column;align-items:center}.item-dragon[_ngcontent-%COMP%]{box-shadow:inset 1px 1px 12px 1px #242936;background-color:#2429360d;width:100%;padding:5px;display:grid;grid-template-columns:200px 100px 100px;text-align:left}.item-dragon[_ngcontent-%COMP%]:hover{box-shadow:inset 1px 1px 12px 1px #101217;background-color:#1012170d}.item-dragon-header[_ngcontent-%COMP%]{box-shadow:inset 1px 1px 8px 1px #ffeeca;background-color:#ffeeca0d;margin-bottom:4px;border-bottom:2px solid #FFEECA;font-weight:600}.item-dragon-header[_ngcontent-%COMP%]:hover{box-shadow:inset 1px 1px 8px 1px #ffe6b1;background-color:#ffe6b10d}.btn-battle[_ngcontent-%COMP%]{width:72px;height:24px;line-height:24px;text-align:center}.wrapper-table-btns[_ngcontent-%COMP%]{width:100%;margin-top:10px;display:flex;gap:1%}.wrapper-table-btns[_ngcontent-%COMP%]   .btn-table[_ngcontent-%COMP%]{width:50%;height:24px;line-height:24px}@media screen and (max-width: 990px){.item-dragon[_ngcontent-%COMP%]{padding:5px;display:flex;justify-content:space-between;text-align:left}.btn-battle[_ngcontent-%COMP%]{margin-right:2px}}"],changeDetection:0}),n})();var M=s(4549),L=s(6352),F=s(7937),me=s(7654),_e=s(3688);const ue=["searchName"],he=["searchMinLevel"],xe=["searchMaxLevel"],fe=["searchRarity"],ve=["searchType"];function Ze(n,a){1&n&&(e.TgZ(0,"div",24),e._UZ(1,"app-loading-indicator"),e.qZA())}function Ce(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).confirmBuyAuction(o)}),e.ALo(1,"async"),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("disabled",e.lcZ(1,2,t.actionLoading$)),e.xp6(2),e.hij(" ",e.lcZ(3,4,"auctions.buy")," ")}}function be(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).cancelAuction(o.id)}),e.ALo(1,"async"),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("disabled",e.lcZ(1,2,t.actionLoading$)),e.xp6(2),e.hij(" ",e.lcZ(3,4,"common.cancel")," ")}}const Ae=function(n){return{price:n}};function we(n,a){if(1&n&&(e.TgZ(0,"div",26),e.TgZ(1,"div",27),e.TgZ(2,"div",28),e.TgZ(3,"div",29),e._UZ(4,"app-item-display",30),e.TgZ(5,"div",31),e._uU(6),e.ALo(7,"translate"),e._UZ(8,"br"),e._uU(9),e.ALo(10,"translate"),e.TgZ(11,"div",32),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",33),e._uU(15),e.ALo(16,"translate"),e.ALo(17,"date"),e.qZA(),e.qZA(),e.YNc(18,Ce,4,6,"button",34),e.YNc(19,be,4,6,"button",34),e.qZA(),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(4),e.Q6J("item",t.item)("simplified",!0),e.xp6(2),e.AsE(" ",e.lcZ(7,11,"auctions.quantity"),": ",t.quantity," "),e.xp6(3),e.AsE(" ",e.lcZ(10,13,"auctions.price"),": ",t.totalGoldPrice," "),e.xp6(3),e.hij(" (",e.xi3(13,15,"auctions.unitPriceCalculated",e.VKq(23,Ae,t.totalGoldPrice/t.quantity)),") "),e.xp6(3),e.AsE(" ",e.lcZ(16,18,"auctions.endTime"),": ",e.xi3(17,20,t.endTime,"short")," "),e.xp6(3),e.Q6J("ngIf",t.sellerId!==i.user.id),e.xp6(1),e.Q6J("ngIf",t.sellerId===i.user.id)}}function Te(n,a){if(1&n&&(e.TgZ(0,"div",3),e.YNc(1,we,20,25,"div",25),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}function ye(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",4),e.TgZ(1,"button",5),e.NdJ("click",function(){return e.CHM(t),e.oxw().getAuctions(!1)}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",5),e.NdJ("click",function(){return e.CHM(t),e.oxw().getAuctions(!0)}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.canGetPrev),e.xp6(1),e.hij(" ",e.lcZ(3,4,"common.prev")," "),e.xp6(2),e.Q6J("disabled",!t.canGetNext),e.xp6(1),e.hij(" ",e.lcZ(6,6,"common.next")," ")}}function Me(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-auction-create",36),e.NdJ("close",function(){e.CHM(t);const o=e.oxw();return o.getAuctions(!1),o.displayCreateForm=!1}),e.qZA()}}const Oe=function(n,a,t){return{quantity:n,name:a,gold:t}};function Ue(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-confirm-modal",37),e.NdJ("confirm",function(){e.CHM(t);const o=e.oxw();return o.buyAuction(o.selectedAuction.id)})("close",function(){return e.CHM(t),e.oxw().displayBuyAuctionModal=!1}),e.ALo(1,"translate"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("message",e.xi3(1,1,"auctions.confirmPurchaseMessage",e.kEZ(4,Oe,t.selectedAuction.quantity,t.selectedAuction.displayItem.name,t.selectedAuction.totalGoldPrice)))}}let Pe=(()=>{class n{constructor(t,i,o,r,p){this.actionController=t,this.auctionController=i,this.engineService=o,this.toastService=r,this.itemsService=p,this.displayOwned=!1,this.displayCreateForm=!1,this.displayBuyAuctionModal=!1,this.actionLoading$=new y.X(!1),this.ItemType=l.qG,this.ItemRarity=l.RG,this.currentPage=0,this.pageLimit=9,this.canGetPrev=!1,this.canGetNext=!0}ngOnInit(){this.user=this.engineService.user,this.getAuctions()}validateSearchParams(){var t,i,o;const r=null===(t=this.searchName)||void 0===t?void 0:t.nativeElement.value;if(r&&(r.length<d.CV||r.length>d.wO))return!1;const p=+(null===(i=this.searchMinLevel)||void 0===i?void 0:i.nativeElement.value);if(p&&(p<d.f5||p>d.dj))return!1;const m=+(null===(o=this.searchMaxLevel)||void 0===o?void 0:o.nativeElement.value);return!(m&&(m<d.f5||m>d.dj)||p&&m&&p>m)}getAuctions(t){var i,o,r,p,m,w,P;if(!this.validateSearchParams())return void this.toastService.showError("errors.formInvalid","errors.formInvalidHint");!0===t?this.currentPage+=1:!1===t?this.currentPage-=1:this.currentPage=0,this.currentPage<0&&(this.currentPage=0);const S={page:this.currentPage,limit:this.pageLimit,ownedByUser:this.displayOwned,name:null===(i=this.searchName)||void 0===i?void 0:i.nativeElement.value,type:null!==(r=null===(o=this.searchType)||void 0===o?void 0:o.nativeElement.value)&&void 0!==r?r:void 0,requiredRarity:null!==(m=null===(p=this.searchRarity)||void 0===p?void 0:p.nativeElement.value)&&void 0!==m?m:void 0,minLevel:(null===(w=this.searchMinLevel)||void 0===w?void 0:w.nativeElement.value)?Math.floor(+this.searchMinLevel.nativeElement.value):d.f5,maxLevel:(null===(P=this.searchMaxLevel)||void 0===P?void 0:P.nativeElement.value)?Math.floor(+this.searchMaxLevel.nativeElement.value):d.dj};this.actionLoading$.next(!0),this.auctions$=this.auctionController.getAll(S).pipe((0,v.b)(b=>{this.canGetPrev=0!==this.currentPage,this.canGetNext=(this.currentPage+1)*this.pageLimit<b.meta.totalItems,this.actionLoading$.next(!1)}),(0,g.U)(b=>b.data),(0,g.U)(b=>this.displayOwned?b.filter(N=>N.sellerId===this.user.id):b))}changeMode(t){this.displayOwned=t,this.currentPage=0,this.getAuctions()}confirmBuyAuction(t){this.selectedAuction=this.itemsService.toDisplayAuction(t),this.displayBuyAuctionModal=!0}buyAuction(t){this.displayBuyAuctionModal=!1,this.actionLoading$.next(!0),this.actionController.buyAuction(t.toString()).subscribe(i=>{this.toastService.showSuccess("common.success","auctions.purchaseCompleted"),this.user.gold=this.user.gold-i.consumedGold,this.engineService.updateUser({gold:this.user.gold}),this.getAuctions()},()=>this.actionLoading$.next(!1))}cancelAuction(t){this.actionLoading$.next(!0),this.auctionController.cancel(t.toString()).subscribe(()=>{this.toastService.showSuccess("common.success","auctions.offerCancelled"),this.getAuctions()},()=>this.actionLoading$.next(!1))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.iQ),e.Y36(l.wY),e.Y36(M.S),e.Y36(Z.k),e.Y36(L.L))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-auctions"]],viewQuery:function(t,i){if(1&t&&(e.Gf(ue,5),e.Gf(he,5),e.Gf(xe,5),e.Gf(fe,5),e.Gf(ve,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.searchName=o.first),e.iGM(o=e.CRH())&&(i.searchMinLevel=o.first),e.iGM(o=e.CRH())&&(i.searchMaxLevel=o.first),e.iGM(o=e.CRH())&&(i.searchRarity=o.first),e.iGM(o=e.CRH())&&(i.searchType=o.first)}},decls:71,vars:76,consts:[[1,"wrapper-main"],["currentLocation","auctions"],[1,"wrapper-content"],[1,"wrapper-auctions"],[1,"wrapper-menu"],[1,"btn-base","btn-mode",3,"disabled","click"],[1,"wrapper-menu","wrapper-search"],[1,"input-text",3,"placeholder"],["searchName",""],["type","number",1,"input-text",3,"placeholder"],["searchMinLevel",""],["searchMaxLevel",""],[1,"input-select"],["searchRarity",""],["value",""],[3,"value"],["searchType",""],[1,"btn-base","btn-search",3,"disabled","click"],[1,"wrapper-table"],["auctionsLoading",""],["class","wrapper-auctions",4,"ngIf","ngIfElse"],["class","wrapper-menu",4,"ngIf"],[3,"close",4,"ngIf"],["title","auctions.confirmPurchase",3,"message","confirm","close",4,"ngIf"],[2,"margin","30px auto"],["style","width: 100%;",4,"ngFor","ngForOf"],[2,"width","100%"],[1,"item-auction"],[2,"width","100%","display","flex","align-items","center"],[1,"item-auction-data"],[2,"width","45px","height","45px",3,"item","simplified"],[2,"margin-left","16px"],[1,"inline","no-mobile"],[1,"no-mobile"],["class","btn-base btn-auction",3,"disabled","click",4,"ngIf"],[1,"btn-base","btn-auction",3,"disabled","click"],[3,"close"],["title","auctions.confirmPurchase",3,"message","confirm","close"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"button",5),e.NdJ("click",function(){return i.changeMode(!1)}),e.ALo(6,"async"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.changeMode(!0)}),e.ALo(10,"async"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"button",5),e.NdJ("click",function(){return i.displayCreateForm=!0}),e.ALo(14,"async"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.qZA(),e.TgZ(17,"div",6),e._UZ(18,"input",7,8),e.ALo(20,"translate"),e._UZ(21,"input",9,10),e.ALo(23,"translate"),e._UZ(24,"input",9,11),e.ALo(26,"translate"),e.TgZ(27,"select",12,13),e.TgZ(29,"option",14),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"option",15),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"option",15),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"option",15),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.TgZ(41,"option",15),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.qZA(),e.TgZ(44,"select",12,16),e.TgZ(46,"option",14),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"option",15),e._uU(50),e.ALo(51,"translate"),e.qZA(),e.TgZ(52,"option",15),e._uU(53),e.ALo(54,"translate"),e.qZA(),e.TgZ(55,"option",15),e._uU(56),e.ALo(57,"translate"),e.qZA(),e.qZA(),e.TgZ(58,"button",17),e.NdJ("click",function(){return i.getAuctions()}),e.ALo(59,"async"),e._uU(60),e.ALo(61,"translate"),e.qZA(),e.qZA(),e.TgZ(62,"div",18),e.YNc(63,Ze,2,0,"ng-template",null,19,e.W1O),e.YNc(65,Te,2,1,"div",20),e.ALo(66,"async"),e.qZA(),e.YNc(67,ye,7,8,"div",21),e.ALo(68,"async"),e.qZA(),e.qZA(),e.qZA(),e.YNc(69,Me,1,0,"app-auction-create",22),e.YNc(70,Ue,2,8,"app-confirm-modal",23)),2&t){const o=e.MAs(64);e.xp6(5),e.Q6J("disabled",e.lcZ(6,32,i.actionLoading$)),e.xp6(2),e.hij(" ",e.lcZ(8,34,"auctions.all")," "),e.xp6(2),e.Q6J("disabled",e.lcZ(10,36,i.actionLoading$)),e.xp6(2),e.hij(" ",e.lcZ(12,38,"auctions.owned")," "),e.xp6(2),e.Q6J("disabled",e.lcZ(14,40,i.actionLoading$)),e.xp6(2),e.hij(" ",e.lcZ(16,42,"auctions.addOffer")," "),e.xp6(3),e.s9C("placeholder",e.lcZ(20,44,"auctions.name")),e.xp6(3),e.s9C("placeholder",e.lcZ(23,46,"auctions.minLevel")),e.xp6(3),e.s9C("placeholder",e.lcZ(26,48,"auctions.maxLevel")),e.xp6(6),e.Oqu(e.lcZ(31,50,"auctions.itemRarity")),e.xp6(2),e.Q6J("value",i.ItemRarity.Common),e.xp6(1),e.Oqu(e.lcZ(34,52,"enums.itemRarity.Common")),e.xp6(2),e.Q6J("value",i.ItemRarity.Scarce),e.xp6(1),e.Oqu(e.lcZ(37,54,"enums.itemRarity.Scarce")),e.xp6(2),e.Q6J("value",i.ItemRarity.Rare),e.xp6(1),e.Oqu(e.lcZ(40,56,"enums.itemRarity.Rare")),e.xp6(2),e.Q6J("value",i.ItemRarity.Mythical),e.xp6(1),e.Oqu(e.lcZ(43,58,"enums.itemRarity.Mythical")),e.xp6(5),e.Oqu(e.lcZ(48,60,"auctions.itemType")),e.xp6(2),e.Q6J("value",i.ItemType.Food),e.xp6(1),e.Oqu(e.lcZ(51,62,"enums.itemType.Food")),e.xp6(2),e.Q6J("value",i.ItemType.Ingredient),e.xp6(1),e.Oqu(e.lcZ(54,64,"enums.itemType.Ingredient")),e.xp6(2),e.Q6J("value",i.ItemType.Equipment),e.xp6(1),e.Oqu(e.lcZ(57,66,"enums.itemType.Equipment")),e.xp6(2),e.Q6J("disabled",e.lcZ(59,68,i.actionLoading$)),e.xp6(2),e.hij(" ",e.lcZ(61,70,"common.search")," "),e.xp6(5),e.Q6J("ngIf",e.lcZ(66,72,i.auctions$))("ngIfElse",o),e.xp6(2),e.Q6J("ngIf",!e.lcZ(68,74,i.actionLoading$)&&(i.canGetPrev||i.canGetNext)),e.xp6(2),e.Q6J("ngIf",i.displayCreateForm),e.xp6(1),e.Q6J("ngIf",i.selectedAuction&&i.displayBuyAuctionModal)}},directives:[h.g,_.YN,_.Kr,x.Q,c.O5,c.sg,F.s,me.A,_e.z],pipes:[c.Ov,u.X$,c.uU],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-content[_ngcontent-%COMP%]{overflow-x:auto}.wrapper-auctions[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.wrapper-menu[_ngcontent-%COMP%]{width:clamp(200px,95%,800px);margin:auto;display:flex;gap:2px}.wrapper-menu[_ngcontent-%COMP%]   .btn-mode[_ngcontent-%COMP%]{width:50%;margin:0;line-height:2;border-radius:2px}.wrapper-search[_ngcontent-%COMP%]{margin-top:-2px;display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));grid-template-rows:repeat(30px);justify-items:stretch;align-items:stretch;grid-gap:0px 2px;gap:0px 2px}.wrapper-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .wrapper-search[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .wrapper-search[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:auto;margin:3px 0 0}.wrapper-search[_ngcontent-%COMP%]   .btn-search[_ngcontent-%COMP%]{max-width:none;height:25px;line-height:25px}.wrapper-table[_ngcontent-%COMP%]{width:clamp(200px,95%,800px);height:590px;margin:auto;padding-bottom:4px;background:#242936;border-radius:2px;overflow:visible}.wrapper-auctions[_ngcontent-%COMP%]{width:100%;margin:5px auto 10px;padding:0 5px;display:flex;gap:5px;flex-direction:column;align-items:center;overflow:visible}.item-auction[_ngcontent-%COMP%]{box-shadow:inset 1px 1px 12px 1px #384055;background-color:#3840550d;width:clamp(200px,100%,100%);height:60px;display:flex;justify-content:space-between;align-items:center;text-align:left;padding:0 10px}.item-auction[_ngcontent-%COMP%]   .item-auction-data[_ngcontent-%COMP%]{width:50%;display:flex;align-items:center}.item-auction[_ngcontent-%COMP%]   .btn-auction[_ngcontent-%COMP%]{height:24px;width:60px;margin:0;line-height:24px;text-align:center}@media screen and (max-width: 990px){.item-auction[_ngcontent-%COMP%]{justify-content:center}.item-auction[_ngcontent-%COMP%]   .item-auction-data[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0}),n})();var qe=s(6990);function Ie(n,a){1&n&&(e.TgZ(0,"div",13),e._UZ(1,"app-loading-indicator"),e.qZA())}function Le(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-crafting-item-list",14),e.NdJ("refreshItems",function(){return e.CHM(t),e.oxw(2).getOwnedItems()}),e.qZA()}if(2&n){const t=a.ngIf;e.Q6J("items",t.items)("recipes",t.recipes)}}const Q=function(n,a){return{items:n,recipes:a}};function Se(n,a){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Ie,2,0,"div",11),e.ALo(2,"async"),e.YNc(3,Le,1,2,"app-crafting-item-list",12),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()),2&n){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",!(null!=(i=e.lcZ(2,2,t.recipesBase$))&&i.length)),e.xp6(2),e.Q6J("ngIf",e.WLB(8,Q,e.lcZ(4,4,t.items$),e.lcZ(5,6,t.recipesBase$)))}}function Ne(n,a){1&n&&(e.TgZ(0,"div",13),e._UZ(1,"app-loading-indicator"),e.qZA())}function De(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-crafting-item-list",14),e.NdJ("refreshItems",function(){return e.CHM(t),e.oxw(2).getOwnedItems()}),e.qZA()}if(2&n){const t=a.ngIf;e.Q6J("items",t.items)("recipes",t.recipes)}}function Ee(n,a){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Ne,2,0,"div",11),e.ALo(2,"async"),e.YNc(3,De,1,2,"app-crafting-item-list",12),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()),2&n){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",!(null!=(i=e.lcZ(2,2,t.recipesSpecial$))&&i.length)),e.xp6(2),e.Q6J("ngIf",e.WLB(8,Q,e.lcZ(4,4,t.items$),e.lcZ(5,6,t.recipesSpecial$)))}}let ke=(()=>{class n{constructor(t){this.itemController=t,this.items$=new A.y,this.recipesBase$=new A.y,this.recipesSpecial$=new A.y,this.displayBaseRecipes=!1,this.displaySpecialRecipes=!1}ngOnInit(){this.getOwnedItems(),this.getRecipes()}getOwnedItems(){this.items$=this.itemController.getOwnedItems().pipe((0,g.U)(t=>t.data))}getRecipes(){this.recipesBase$=this.itemController.getRuneBaseRecipes(),this.recipesSpecial$=this.itemController.getRuneSpecialRecipes()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.l3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-crafting"]],decls:27,vars:14,consts:[[1,"wrapper-main"],["currentLocation","crafting"],[1,"wrapper-content"],[1,"wrapper-crafting-section"],[1,"wrapper-lore"],[1,"wrapper-lore-img"],["src","assets/img/lore/crafting-base-runes.png","draggable","false","alt","Goblin thinkerer"],[1,"wrapper-lore-text"],[1,"btn-base","btn-small",3,"click"],[4,"ngIf"],["src","assets/img/lore/crafting-special-runes.png","draggable","false","alt","Goblin thinkerer"],["style","margin: 30px auto;",4,"ngIf"],[3,"items","recipes","refreshItems",4,"ngIf"],[2,"margin","30px auto"],[3,"items","recipes","refreshItems"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e._UZ(6,"img",6),e.qZA(),e.TgZ(7,"div",7),e.TgZ(8,"div"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return i.displayBaseRecipes=!i.displayBaseRecipes}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.qZA(),e.qZA(),e.YNc(14,Se,6,11,"div",9),e.qZA(),e.TgZ(15,"div",3),e.TgZ(16,"div",4),e.TgZ(17,"div",5),e._UZ(18,"img",10),e.qZA(),e.TgZ(19,"div",7),e.TgZ(20,"div"),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"button",8),e.NdJ("click",function(){return i.displaySpecialRecipes=!i.displaySpecialRecipes}),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.qZA(),e.qZA(),e.YNc(26,Ee,6,11,"div",9),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(9),e.Oqu(e.lcZ(10,6,"crafting.runeCraftingBaseHint")),e.xp6(3),e.hij(" ",e.lcZ(13,8,"alchemy.toggleOffer")," "),e.xp6(2),e.Q6J("ngIf",i.displayBaseRecipes),e.xp6(7),e.Oqu(e.lcZ(22,10,"crafting.runeCraftingSpecialHint")),e.xp6(3),e.hij(" ",e.lcZ(25,12,"alchemy.toggleOffer")," "),e.xp6(2),e.Q6J("ngIf",i.displaySpecialRecipes))},directives:[h.g,c.O5,x.Q,qe.f],pipes:[u.X$,c.Ov],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-crafting-section[_ngcontent-%COMP%]{box-shadow:inset 1px 1px 12px 1px #000;background-color:#0000000d;margin:10px auto;max-width:900px;padding:10px}.wrapper-lore[_ngcontent-%COMP%]{display:flex;gap:10px;text-align:left}.wrapper-lore-img[_ngcontent-%COMP%]{min-width:125px;width:125px}.wrapper-lore-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%}.wrapper-lore-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;text-align:justify}.wrapper-lore-text[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px 0}@media screen and (max-width: 990px){.wrapper-lore[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:justify}.wrapper-lore[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:125px}}"],changeDetection:0}),n})();var I=s(5770);function $e(n,a){1&n&&(e.TgZ(0,"div",9),e._UZ(1,"app-loading-indicator"),e.qZA())}function Je(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=a.$implicit,i=a.index,o=e.oxw(2).$implicit;e.Tol("inline color-"+t.rarity),e.xp6(1),e.hij(" ",t.name+" ("+t.quantity+")"+(i+1<o.requiredItems.length?", ":"")," ")}}function Fe(n,a){if(1&n&&(e.TgZ(0,"div",17),e._uU(1),e.ALo(2,"translate"),e.YNc(3,Je,2,3,"div",19),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,2,"dragonTamer.requiredItems"),": "),e.xp6(2),e.Q6J("ngForOf",t.requiredItems)}}function Qe(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",12),e.TgZ(1,"div",13),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div"),e._UZ(5,"input",14,15),e.ALo(7,"async"),e.ALo(8,"translate"),e.qZA(),e.YNc(9,Fe,4,4,"div",16),e.TgZ(10,"div",17),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"button",18),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.MAs(6);return e.oxw(2).summonDragon(r,p.value)}),e.ALo(14,"async"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.hij(" ",e.lcZ(3,8,t.hint)," "),e.xp6(3),e.s9C("placeholder",e.lcZ(8,12,"auctions.name")),e.Q6J("disabled",e.lcZ(7,10,i.actionsLoading$)),e.xp6(4),e.Q6J("ngIf",t.requiredItems&&t.requiredItems.length),e.xp6(2),e.AsE(" ",e.lcZ(12,14,"dragonTamer.actionCost"),": ",t.cost," "),e.xp6(2),e.Q6J("disabled",e.lcZ(14,16,i.actionsLoading$)),e.xp6(2),e.hij(" ",e.lcZ(16,18,"dragonSummon.summon")," ")}}function Ye(n,a){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,Qe,17,20,"div",11),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}let He=(()=>{class n{constructor(t,i,o,r,p,m,w){this.router=t,this.actionController=i,this.dragonController=o,this.toastService=r,this.validatorService=p,this.engineService=m,this.repositoryService=w,this.actions$=new A.y,this.actionsLoading$=new y.X(!1)}ngOnInit(){this.user=this.repositoryService.getUserData(),this.getSummonActions()}getSummonActions(){this.actions$=this.dragonController.getSummonActions()}summonDragon(t,i){if(!this.validatorService.checkBannedWords(i))return;if(i.length<d.EN||i.length>d.Eh)return void this.toastService.showError("errors.error","errors.dragonNameIncorrectLength",null,{min:d.EN,max:d.Eh});if(this.user&&this.user.gold<t.cost)return void this.toastService.showError("errors.error","errors.insufficientsFound");const o={actionUid:t.uid,name:i,nature:t.nature};this.actionsLoading$.next(!0),this.actionController.summonDragon(o).subscribe(r=>{this.toastService.showSuccess("common.success","dragonSummon.summonSuccess"),this.actionsLoading$.next(!1),this.engineService.tick(),this.router.navigate(["game","my-dragons"])},()=>this.actionsLoading$.next(!1))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.F0),e.Y36(l.iQ),e.Y36(l.GE),e.Y36(Z.k),e.Y36(q.o),e.Y36(M.S),e.Y36(I.b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dragon-summon"]],decls:13,vars:7,consts:[[1,"wrapper-main"],["currentLocation","dragon-summoner"],[1,"wrapper-content"],[1,"wrapper-actions-section"],[1,"wrapper-lore"],[1,"wrapper-lore-img"],["src","assets/img/lore/dragon-summoner.png","draggable","false","alt","Dragon summoner"],["loading",""],["class","wrapper-actions",4,"ngIf","ngIfElse"],[2,"margin","30px auto"],[1,"wrapper-actions"],["class","item-action",4,"ngFor","ngForOf"],[1,"item-action"],[1,"action-hint"],[1,"input-text",3,"disabled","placeholder"],["nameInput",""],["class","cost-hint",4,"ngIf"],[1,"cost-hint"],[1,"btn-base","btn-action",3,"disabled","click"],[3,"class",4,"ngFor","ngForOf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e._UZ(6,"img",6),e.qZA(),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.YNc(9,$e,2,0,"ng-template",null,7,e.W1O),e.YNc(11,Ye,2,1,"div",8),e.ALo(12,"async"),e.qZA(),e.qZA(),e.qZA()),2&t){const o=e.MAs(10);e.xp6(7),e.hij(" ",e.lcZ(8,3,"dragonSummon.dragonSummonerHint")," "),e.xp6(4),e.Q6J("ngIf",e.lcZ(12,5,i.actions$))("ngIfElse",o)}},directives:[h.g,x.Q,c.O5,c.sg],pipes:[u.X$,c.Ov],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-actions-section[_ngcontent-%COMP%]{box-shadow:inset 1px 1px 12px 1px #000;background-color:#0000000d;margin:0 10px 10px;max-width:900px;padding:10px}.wrapper-lore[_ngcontent-%COMP%]{margin-bottom:5px;display:flex;text-align:left;gap:10px}.wrapper-lore-img[_ngcontent-%COMP%]{min-width:125px;width:125px}.wrapper-lore-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%}.item-action[_ngcontent-%COMP%]{margin-top:10px;padding:10px;text-align:left;background-color:#242936}.btn-action[_ngcontent-%COMP%]{width:240px;height:22px;margin:10px 0;line-height:22px}@media screen and (max-width: 990px){.wrapper-lore[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:justify}}"],changeDetection:0}),n})();const je=["nameInput"],Ge=["newNatureSelect"];function Re(n,a){1&n&&(e.TgZ(0,"div",9),e._UZ(1,"app-loading-indicator"),e.qZA())}function Be(n,a){if(1&n&&(e.TgZ(0,"option",22),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",a.index),e.xp6(1),e.AsE(" ",t.name," [",t.level,"] ")}}function We(n,a){1&n&&(e.TgZ(0,"div"),e.TgZ(1,"div",23),e._uU(2,"New name:"),e.qZA(),e._UZ(3,"input",24,25),e.ALo(5,"translate"),e.qZA()),2&n&&(e.xp6(3),e.s9C("placeholder",e.lcZ(5,1,"auctions.name")))}function Xe(n,a){if(1&n&&(e.TgZ(0,"option",29),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(e.lcZ(2,2,t.name))}}function ze(n,a){if(1&n&&(e.TgZ(0,"div"),e.TgZ(1,"div",23),e._uU(2,"New nature:"),e.qZA(),e.TgZ(3,"select",26,27),e._UZ(5,"option",16),e.YNc(6,Xe,3,4,"option",28),e.qZA(),e.qZA()),2&n){const t=e.oxw(3);e.xp6(6),e.Q6J("ngForOf",t.basicNatures)}}function Ke(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=a.$implicit,i=a.index,o=e.oxw(2).$implicit;e.Tol("inline color-"+t.rarity),e.xp6(1),e.hij(" ",t.name+" ("+t.quantity+")"+(i+1<o.requiredItems.length?", ":"")," ")}}function Ve(n,a){if(1&n&&(e.TgZ(0,"div",30),e._uU(1),e.ALo(2,"translate"),e.YNc(3,Ke,2,3,"div",31),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,2,"dragonTamer.requiredItems"),": "),e.xp6(2),e.Q6J("ngForOf",t.requiredItems)}}function et(n,a){if(1&n&&(e.TgZ(0,"div",32),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.AsE(" ",e.lcZ(2,2,"dragonTamer.currentDragonLimit"),": ",null==t.user?null:t.user.maxOwnedDragons," ")}}function tt(n,a){if(1&n&&(e.TgZ(0,"div",30),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.MAs(5),o=e.oxw().ngIf;e.xp6(1),e.AsE(" ",e.lcZ(2,2,"dragonTamer.actionCost"),": ",""!=i.value&&o.dragons?t.baseCost+o.dragons[+i.value].level*t.costFactor:"---"," ")}}function nt(n,a){if(1&n&&(e.TgZ(0,"div",32),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.AsE(" ",e.lcZ(2,2,"dragonTamer.actionCost"),": ",t.baseCost+t.costFactor*(null!=i.user&&i.user.maxOwnedDragons?i.user.maxOwnedDragons-i.DRAGON_BASE_LIMIT:0)," ")}}function it(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,r=e.MAs(5),p=e.oxw().ngIf;return e.oxw().performAction(o,p.dragons[+r.value])}),e.ALo(1,"async"),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&n){e.oxw();const t=e.MAs(5),i=e.oxw(2);e.Q6J("disabled",""==t.value||e.lcZ(1,2,i.dragonsLoading$)),e.xp6(2),e.hij(" ",e.lcZ(3,4,"common.confirm")," ")}}function ot(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).performActionWithoutDragon(o)}),e.ALo(1,"async"),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("disabled",e.lcZ(1,2,t.dragonsLoading$)),e.xp6(2),e.hij(" ",e.lcZ(3,4,"dragonTamer.extend")," ")}}function at(n,a){if(1&n&&(e.TgZ(0,"div",12),e.TgZ(1,"div",13),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"select",14,15),e.NdJ("change",function(){return 0}),e._UZ(6,"option",16),e.YNc(7,Be,2,3,"option",17),e.qZA(),e.YNc(8,We,6,3,"div",18),e.YNc(9,ze,7,1,"div",18),e.YNc(10,Ve,4,4,"div",19),e.YNc(11,et,3,4,"div",20),e.YNc(12,tt,3,4,"div",19),e.YNc(13,nt,3,4,"div",20),e.YNc(14,it,4,6,"button",21),e.YNc(15,ot,4,6,"button",21),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().ngIf;e.xp6(2),e.hij(" ",e.lcZ(3,11,t.hint)," "),e.xp6(2),e.Q6J("hidden",t.withoutDragon),e.xp6(3),e.Q6J("ngForOf",i.dragons),e.xp6(1),e.Q6J("ngIf","tamer-action-1"===t.uid),e.xp6(1),e.Q6J("ngIf","tamer-action-4"===t.uid),e.xp6(1),e.Q6J("ngIf",t.requiredItems&&t.requiredItems.length),e.xp6(1),e.Q6J("ngIf","tamer-action-5"===t.uid),e.xp6(1),e.Q6J("ngIf",!t.withoutDragon),e.xp6(1),e.Q6J("ngIf",t.withoutDragon),e.xp6(1),e.Q6J("ngIf",!t.withoutDragon),e.xp6(1),e.Q6J("ngIf",t.withoutDragon)}}function rt(n,a){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,at,16,13,"div",11),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t.actions)}}const st=function(n,a,t){return{user:n,actions:a,dragons:t}};let ct=(()=>{class n{constructor(t,i,o,r,p,m){this.actionController=t,this.dragonController=i,this.toastService=o,this.validatorService=r,this.engineService=p,this.repositoryService=m,this.DRAGON_BASE_LIMIT=d.FO,this.actionsLoading$=new y.X(!1),this.dragonsLoading$=new y.X(!1)}get basicNatures(){return[{value:l.KP.Fire,name:"enums.dragonNature.Fire"},{value:l.KP.Water,name:"enums.dragonNature.Water"},{value:l.KP.Wind,name:"enums.dragonNature.Wind"},{value:l.KP.Earth,name:"enums.dragonNature.Earth"}]}ngOnInit(){this.user=this.repositoryService.getUserData(),this.getDragonTamerActions(),this.getOwnedDragons()}getDragonTamerActions(){this.actionsLoading$.next(!0),this.actions$=this.dragonController.getTamerActions().pipe((0,v.b)(()=>this.actionsLoading$.next(!1)))}getOwnedDragons(){this.dragonsLoading$.next(!0),this.dragons$=this.dragonController.getOwned().pipe((0,v.b)(()=>this.dragonsLoading$.next(!1)))}performAction(t,i){if(this.user=this.repositoryService.getUserData(),this.user&&this.user.gold<t.baseCost+i.level*t.costFactor)this.toastService.showError("errors.error","errors.insufficientsFound");else if(i.level<t.requiredLevel)this.toastService.showError("errors.error","errors.dragonTooYoung");else switch(t.uid){case"tamer-action-1":this.renameDragon(i);break;case"tamer-action-2":this.resetDragonSkills(i);break;case"tamer-action-3":this.restoreDragonStamina(i);break;case"tamer-action-4":this.changeDragonNature(i);break;default:this.toastService.showError("errors.error","errors.actionNotFound")}}renameDragon(t){const i=this.nameInput.nativeElement.value;if(!this.validatorService.checkBannedWords(i))return;if(i.length<d.EN||i.length>d.Eh)return void this.toastService.showError("errors.error","errors.dragonNameIncorrectLength",null,{min:d.EN,max:d.Eh});const o={dragonId:t.id,newName:i};this.dragonsLoading$.next(!0),this.actionController.renameDragon(o).subscribe(r=>{this.toastService.showSuccess("common.success","dragonTamer.dragonRenamed"),this.getOwnedDragons(),this.engineService.tick(),this.nameInput.nativeElement.value=null},()=>this.dragonsLoading$.next(!1))}resetDragonSkills(t){this.dragonsLoading$.next(!0),this.actionController.resetDragonSkills(t.id.toString()).subscribe(i=>{this.toastService.showSuccess("common.success","dragonTamer.skillsReseted"),this.getOwnedDragons(),this.engineService.tick()},()=>this.dragonsLoading$.next(!1))}restoreDragonStamina(t){this.dragonsLoading$.next(!0),this.actionController.restoreDragonStamina(t.id.toString()).subscribe(i=>{this.toastService.showSuccess("common.success","dragonTamer.staminaRestored"),this.getOwnedDragons(),this.engineService.tick()},()=>this.dragonsLoading$.next(!1))}changeDragonNature(t){const i=this.newNatureSelect.nativeElement.value;if(!i)return;if(i===t.nature)return void this.toastService.showError("errors.error","errors.dragonAlreadyHasThisNature");const o={dragonId:t.id,newNature:i};this.dragonsLoading$.next(!0),this.actionController.changeDragonNature(o).subscribe(r=>{this.toastService.showSuccess("common.success","dragonTamer.natureChanged"),this.getOwnedDragons(),this.engineService.tick()},()=>this.dragonsLoading$.next(!1))}performActionWithoutDragon(t){"tamer-action-5"===t.uid?this.extendDragonLimit(t):this.toastService.showError("errors.error","errors.actionNotFound")}extendDragonLimit(t){this.user=this.repositoryService.getUserData(),this.user&&this.user.gold<t.baseCost?this.toastService.showError("errors.error","errors.insufficientsFound"):(this.dragonsLoading$.next(!0),this.actionController.extendDragonLimit().subscribe(o=>{this.toastService.showSuccess("common.success","dragonTamer.dragonLimitExtended"),this.engineService.tick(),this.getDragonTamerActions(),this.getOwnedDragons(),this.user&&this.user.maxOwnedDragons++},()=>this.dragonsLoading$.next(!1)))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.iQ),e.Y36(l.GE),e.Y36(Z.k),e.Y36(q.o),e.Y36(M.S),e.Y36(I.b))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dragon-tamer"]],viewQuery:function(t,i){if(1&t&&(e.Gf(je,5),e.Gf(Ge,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.nameInput=o.first),e.iGM(o=e.CRH())&&(i.newNatureSelect=o.first)}},decls:14,vars:15,consts:[[1,"wrapper-main"],["currentLocation","dragon-tamer"],[1,"wrapper-content"],[1,"wrapper-actions-section"],[1,"wrapper-lore"],[1,"wrapper-lore-img"],["src","assets/img/lore/dragon-tamer.png","draggable","false","alt","Dragon tamer"],["style","margin: 30px auto;",4,"ngIf"],["class","wrapper-actions",4,"ngIf"],[2,"margin","30px auto"],[1,"wrapper-actions"],["class","item-action",4,"ngFor","ngForOf"],[1,"item-action"],[1,"action-hint"],[1,"input-select",2,"margin-top","8px",3,"hidden","change"],["dragonSelect",""],["value",""],["class","input-select-option",3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","cost-hint",4,"ngIf"],["class","cost-hint","style","margin-top: 8px;",4,"ngIf"],["class","btn-base btn-action",3,"disabled","click",4,"ngIf"],[1,"input-select-option",3,"value"],[1,"label"],[1,"input-text",3,"placeholder"],["nameInput",""],[1,"input-select"],["newNatureSelect",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"cost-hint"],[3,"class",4,"ngFor","ngForOf"],[1,"cost-hint",2,"margin-top","8px"],[1,"btn-base","btn-action",3,"disabled","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e._UZ(6,"img",6),e.qZA(),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.YNc(9,Re,2,0,"div",7),e.ALo(10,"async"),e.YNc(11,rt,2,1,"div",8),e.ALo(12,"async"),e.ALo(13,"async"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(7),e.hij(" ",e.lcZ(8,3,"dragonTamer.dragonTamerHint")," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(10,5,i.actionsLoading$)),e.xp6(2),e.Q6J("ngIf",e.kEZ(11,st,i.user,e.lcZ(12,7,i.actions$),e.lcZ(13,9,i.dragons$))))},directives:[h.g,c.O5,x.Q,c.sg,_.YN,_.Kr],pipes:[u.X$,c.Ov],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-actions-section[_ngcontent-%COMP%]{box-shadow:inset 1px 1px 12px 1px #000;background-color:#0000000d;margin:0 10px 10px;max-width:900px;padding:10px}.wrapper-lore[_ngcontent-%COMP%]{margin-bottom:5px;display:flex;text-align:left;gap:10px}.wrapper-lore-img[_ngcontent-%COMP%]{min-width:125px;width:125px}.wrapper-lore-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%}.item-action[_ngcontent-%COMP%]{margin-top:10px;padding:10px;text-align:left;background-color:#242936}.btn-action[_ngcontent-%COMP%]{width:240px;height:22px;margin:10px 0;line-height:22px}@media screen and (max-width: 990px){.wrapper-lore[_ngcontent-%COMP%]{flex-direction:column;align-items:center;text-align:justify}}"],changeDetection:0}),n})(),lt=(()=>{class n{constructor(){this.BASE_IMG_PATH="assets/img/expeditions"}toDisplayExpedition(t){return Object.assign(Object.assign({},t),{image:`${this.BASE_IMG_PATH}/${t.uid}.png`})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const pt=["selectDragon"];function dt(n,a){1&n&&(e.TgZ(0,"div",9),e._UZ(1,"app-loading-indicator"),e.qZA())}function gt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",12),e.TgZ(1,"div",13),e._UZ(2,"img",14),e.qZA(),e.TgZ(3,"div",15),e.TgZ(4,"b"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._UZ(7,"br"),e._uU(8),e.ALo(9,"translate"),e._UZ(10,"br"),e.TgZ(11,"button",16),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).prepareExpedition(r)}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",16),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).prepareGuardianChallenge(r)}),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=a.$implicit;e.xp6(2),e.Q6J("src",t.image,e.LSH)("alt",t.name),e.xp6(3),e.Oqu(e.lcZ(6,6,t.name)),e.xp6(3),e.hij(" ",e.lcZ(9,8,t.hint)," "),e.xp6(4),e.hij(" ",e.lcZ(13,10,"explore.explore")," "),e.xp6(3),e.hij(" ",e.lcZ(16,12,"explore.challengeGuardian")," ")}}function mt(n,a){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,gt,17,14,"div",11),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}function _t(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",12),e.TgZ(1,"div",13),e._UZ(2,"img",14),e.qZA(),e.TgZ(3,"div",15),e.TgZ(4,"b"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e._UZ(7,"br"),e._uU(8),e.ALo(9,"translate"),e._UZ(10,"br"),e.TgZ(11,"button",16),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).prepareExpedition(r)}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",16),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).prepareGuardianChallenge(r)}),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=a.$implicit;e.xp6(2),e.Q6J("src",t.image,e.LSH)("alt",t.name),e.xp6(3),e.Oqu(e.lcZ(6,6,t.name)),e.xp6(3),e.hij(" ",e.lcZ(9,8,t.hint)," "),e.xp6(4),e.hij(" ",e.lcZ(13,10,"explore.explore")," "),e.xp6(3),e.hij(" ",e.lcZ(16,12,"explore.challengeGuardian")," ")}}function ut(n,a){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,_t,17,14,"div",11),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}function ht(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-dragon-choice-modal",17),e.NdJ("close",function(){return e.CHM(t),e.oxw().showDragonChoiceModal=!1})("dragonSelected",function(o){e.CHM(t);const r=e.oxw();return r.dragonChoiceCallback(o,r.selectedExpedition)}),e.qZA()}if(2&n){const t=e.oxw(),i=e.MAs(14);e.Q6J("title",t.modalTitle)("message",t.modalMessage)("dragonTemplate",i)}}function xt(n,a){1&n&&(e.TgZ(0,"div",19),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" (",e.lcZ(2,1,"explore.fullAccess"),") "))}function ft(n,a){if(1&n&&(e.TgZ(0,"div",18),e._uU(1),e.qZA(),e.TgZ(2,"div",19),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,xt,3,3,"div",20)),2&n){const t=a.$implicit,i=e.oxw();e.xp6(1),e.AsE(" ",t.name," [",t.level,"] "),e.xp6(2),e.AsE(" ",t.stamina," ",e.lcZ(4,5,"dragon.stamina")," "),e.xp6(2),e.Q6J("ngIf",t.unlockedExpeditions.includes(null==i.selectedExpedition?null:i.selectedExpedition.uid))}}function vt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-dragon-battle",21),e.NdJ("updatedDragon",function(){return e.CHM(t),e.oxw().displayBattle=!1}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("ownedDragon",t.selectedDragon)("expedition",t.selectedExpedition)}}let Zt=(()=>{class n{constructor(t,i,o,r,p,m){this.translateService=t,this.actionController=i,this.dragonActionController=o,this.dateService=r,this.toastService=p,this.expeditionService=m,this.showDragonChoiceModal=!1,this.requiredLevel=0,this.displayBattle=!1}ngOnInit(){this.getExpeditions(),this.dragonChoiceCallback=this.startExpedition.bind(this)}getExpeditions(){this.expeditions$=this.dragonActionController.getExpeditions().pipe((0,g.U)(t=>t.data.map(i=>this.expeditionService.toDisplayExpedition(i)))),this.expeditionsEvent$=this.dragonActionController.getExpeditionsEvent().pipe((0,g.U)(t=>t.data.map(i=>this.expeditionService.toDisplayExpedition(i))))}prepareExpedition(t){const i={location:this.translateService.instant(t.name)};this.modalTitle=this.translateService.instant("explore.startExpeditionOf",i),this.modalMessage=this.translateService.instant("explore.startExpeditionHint",{level:t.level}),this.dragonChoiceCallback=this.startExpedition.bind(this),this.selectedExpedition=t,this.showDragonChoiceModal=!0,this.requiredLevel=t.level}prepareGuardianChallenge(t){const i={location:this.translateService.instant(t.name)};this.modalTitle=this.translateService.instant("explore.battleGuardianTitle",i),this.modalMessage=this.translateService.instant("explore.battleGuardianHint",{guardianName:t.guardian.name,level:t.guardian.level}),this.dragonChoiceCallback=this.battleGuardian.bind(this),this.selectedExpedition=t,this.showDragonChoiceModal=!0,this.requiredLevel=t.guardian.level}startExpedition(t,i){this.dateService.checkIfEventAvailable(t.action.nextAction)?(this.showDragonChoiceModal=!1,this.actionController.startExpedition({dragonId:t.id,expeditionUid:i.uid}).subscribe(()=>{this.toastService.showSuccess("explore.expeditionStarted","explore.expeditionStartedHint")})):this.toastService.showError("errors.error","errors.dragonBusy")}battleGuardian(t,i){this.dateService.checkIfEventAvailable(t.action.nextAction)?(this.selectedDragon=t,this.showDragonChoiceModal=!1,this.displayBattle=!0):this.toastService.showError("errors.error","errors.dragonBusy")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.sK),e.Y36(l.iQ),e.Y36(l.u8),e.Y36(E.R),e.Y36(Z.k),e.Y36(lt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-expeditions"]],viewQuery:function(t,i){if(1&t&&e.Gf(pt,5),2&t){let o;e.iGM(o=e.CRH())&&(i.selectDragon=o.first)}},decls:16,vars:13,consts:[[1,"wrapper-main"],["currentLocation","expeditions"],[1,"wrapper-content"],[1,"title"],["expeditionsLoading",""],["class","wrapper-expeditions",4,"ngIf","ngIfElse"],[3,"title","message","dragonTemplate","close","dragonSelected",4,"ngIf"],["dragonTemplate",""],[3,"ownedDragon","expedition","updatedDragon",4,"ngIf"],[2,"margin-top","50px"],[1,"wrapper-expeditions"],["class","expedition",4,"ngFor","ngForOf"],[1,"expedition"],[1,"expedition-img"],["draggable","false",3,"src","alt"],[1,"expedition-hint"],[1,"btn-base",3,"click"],[3,"title","message","dragonTemplate","close","dragonSelected"],[2,"margin-bottom","-3px"],[1,"inline","label-small"],["class","inline label-small",4,"ngIf"],[3,"ownedDragon","expedition","updatedDragon"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.YNc(6,dt,2,0,"ng-template",null,4,e.W1O),e.YNc(8,mt,2,1,"div",5),e.ALo(9,"async"),e.YNc(10,ut,2,1,"div",5),e.ALo(11,"async"),e.qZA(),e.YNc(12,ht,1,3,"app-dragon-choice-modal",6),e.YNc(13,ft,6,7,"ng-template",null,7,e.W1O),e.YNc(15,vt,1,2,"app-dragon-battle",8),e.qZA()),2&t){const o=e.MAs(7);e.xp6(4),e.Oqu(e.lcZ(5,7,"explore.explorePageTitle")),e.xp6(4),e.Q6J("ngIf",e.lcZ(9,9,i.expeditionsEvent$))("ngIfElse",o),e.xp6(2),e.Q6J("ngIf",e.lcZ(11,11,i.expeditions$))("ngIfElse",o),e.xp6(2),e.Q6J("ngIf",i.showDragonChoiceModal&&i.selectedExpedition),e.xp6(3),e.Q6J("ngIf",i.selectedExpedition&&i.displayBattle)}},directives:[h.g,x.Q,c.O5,c.sg,k.q,$._],pipes:[u.X$,c.Ov],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-expeditions[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.expedition[_ngcontent-%COMP%]{width:95%;max-width:828px;margin:10px auto;display:grid;grid-gap:0px 8px;gap:0px 8px;grid-template-columns:repeat(auto-fit,minmax(200px,400px));box-shadow:inset 1px 1px 24px 12px #242936;justify-content:center;text-align:center;padding:8px}.expedition-img[_ngcontent-%COMP%]{width:100%;max-width:200px;max-height:200px;margin:auto;box-shadow:inset 1px 1px 24px 12px #242936}.expedition-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.expedition-hint[_ngcontent-%COMP%]{min-width:100px;max-width:400px;padding:8px;text-align:justify;letter-spacing:.5px}.expedition-hint[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{letter-spacing:1.5px}.btn-base[_ngcontent-%COMP%]{width:100%;max-width:100%;margin:12px 0 0;height:22px;line-height:20px}"],changeDetection:0}),n})();var Ct=s(2603);function bt(n,a){1&n&&(e.TgZ(0,"div",12),e._UZ(1,"app-loading-indicator"),e.qZA())}function At(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"span"),e._uU(1," | "),e.TgZ(2,"a",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().showUserDetails(o.userId)}),e._uU(3),e.qZA(),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.userNickname)}}const wt=function(n){return{"font-size":n}},Tt=function(n){return{"dragon-first":n}};function yt(n,a){if(1&n&&(e.TgZ(0,"div",13),e._uU(1),e.ALo(2,"shortNumber"),e.ALo(3,"translate"),e.YNc(4,At,4,1,"span",14),e.qZA()),2&n){const t=a.$implicit,i=a.index;e.Q6J("ngStyle",e.VKq(12,wt,"clamp(13px, "+(18-1.5*i)+"px, 18px)"))("ngClass",e.VKq(14,Tt,0===i)),e.xp6(1),e.xDo(" ",i+1,". ",t.name," [",t.level,"] | ",e.lcZ(2,8,t.experience)," ",e.lcZ(3,10,"dragon.exp")," "),e.xp6(3),e.Q6J("ngIf",t.userNickname)}}let Mt=(()=>{class n{constructor(t,i){this.router=t,this.dragonController=i,this.dragons$=new A.y,this.dragonsLoading=!1}ngOnInit(){this.getTopDragons()}getTopDragons(){this.dragons$=this.dragonController.getBest()}showUserDetails(t){this.router.navigate(["game","profile",t])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.F0),e.Y36(l.GE))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-home"]],decls:206,vars:10,consts:[[1,"wrapper-main"],["currentLocation","home"],[1,"wrapper-content"],[1,"section-news"],[1,"title"],[1,"wrapper-news"],[1,"item-news"],[2,"color","gold"],[1,"wrapper-dragons"],["style","margin-top: 50px;",4,"ngIf"],[1,"reports-scroll"],["class","item-dragon",3,"ngStyle","ngClass",4,"ngFor","ngForOf"],[2,"margin-top","50px"],[1,"item-dragon",3,"ngStyle","ngClass"],[4,"ngIf"],[3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",5),e.TgZ(8,"div",6),e.TgZ(9,"p"),e.TgZ(10,"b",7),e._uU(11,"01.01.2023 "),e._UZ(12,"br"),e._uU(13,"Update - New Year's event."),e.qZA(),e.qZA(),e._uU(14," 1. For a limited amount of time, a special expedition will be available. "),e._UZ(15,"br"),e._uU(16," 2. During the event, all expeditions will require 50% less time to complete. "),e._UZ(17,"br"),e._uU(18," 3. Implemented password recovery and improved backend safety - rate limiting. "),e._UZ(19,"br"),e._uU(20," 4. Next update: backend performance, Angular version update. "),e.qZA(),e.TgZ(21,"div",6),e.TgZ(22,"p"),e.TgZ(23,"b"),e._uU(24,"11.12.2022 "),e._UZ(25,"br"),e._uU(26,"Technical review."),e.qZA(),e.qZA(),e._uU(27," 1. QoL changes - marketplace auction form, new tooltips. "),e._UZ(28,"br"),e._uU(29," 2. Frontend optimization - refactored change detection, disposal of Bootstrap lib. "),e._UZ(30,"br"),e._uU(31," 3. Safety - updated JWT mechanism, added automated tests. "),e._UZ(32,"br"),e._uU(33," 4. Next update: New Year's event. "),e.qZA(),e.TgZ(34,"div",6),e.TgZ(35,"p"),e.TgZ(36,"b"),e._uU(37,"20.09.2022 "),e._UZ(38,"br"),e._uU(39,"Update - User roles."),e.qZA(),e.qZA(),e._uU(40," 1. Introduced new user roles - Moderators and Administrators. "),e._UZ(41,"br"),e._uU(42," 2. Players can now be muted or banned for an inappropriate behavior. "),e._UZ(43,"br"),e._uU(44," 3. Players can now view profiles by clicking on a nickname in the Shoutbox tab. "),e._UZ(45,"br"),e._uU(46," 4. Next update: performacne optimization, code refactoring. "),e.qZA(),e.TgZ(47,"div",6),e.TgZ(48,"p"),e.TgZ(49,"b"),e._uU(50,"13.08.2022 "),e._UZ(51,"br"),e._uU(52,"Update - Social medias."),e.qZA(),e.qZA(),e._uU(53," 1. Introduced user profiles. "),e._UZ(54,"br"),e._uU(55," 2. Added achievements and friends mechanics. "),e._UZ(56,"br"),e._uU(57," 3. Updated lore-related graphics. "),e._UZ(58,"br"),e._uU(59," 4. For the next week expeditions and dragon feeding will require 50% less time to complete. "),e._UZ(60,"br"),e._uU(61," 5. Next update: Player roles, banning system & marketplace bots. "),e.qZA(),e.TgZ(62,"div",6),e.TgZ(63,"p"),e.TgZ(64,"b"),e._uU(65,"25.06.2022 "),e._UZ(66,"br"),e._uU(67,"Update - Expeditions expansion."),e.qZA(),e.qZA(),e._uU(68," 1. Introduced expedition guardians. "),e._UZ(69,"br"),e._uU(70," 2. Expanded crafting section - new tinkerer, more runes. "),e._UZ(71,"br"),e._uU(72," 3. Added new dragon skills, minor skills rebalance. "),e._UZ(73,"br"),e._uU(74," 4. Removed Transient Caverns location, updated loot templates for other expeditions. "),e._UZ(75,"br"),e._uU(76," 5. Next update: Player profiles & QoL changes. "),e.qZA(),e.TgZ(77,"div",6),e.TgZ(78,"p"),e.TgZ(79,"b"),e._uU(80,"05.06.2022 "),e._UZ(81,"br"),e._uU(82,"Technical review."),e.qZA(),e.qZA(),e._uU(83," 1. Expedition rebalance - normalized gold awards, removed experience. "),e._UZ(84,"br"),e._uU(85," 2. Updated dragon tamer offer - prices, owned dragons limit."),e._UZ(86,"br"),e._uU(87," 3. For the next week potion composing will require 50% less time. "),e._UZ(88,"br"),e.qZA(),e.TgZ(89,"div",6),e.TgZ(90,"p"),e.TgZ(91,"b"),e._uU(92,"27.05.2022 "),e._UZ(93,"br"),e._uU(94,"Update - Alchemy."),e.qZA(),e.qZA(),e._uU(95," 1. Added alchemy - now players can craft enchanted elixirs and activate temporary boosts on their dragons. "),e._UZ(96,"br"),e._uU(97," 2. New expedition added, new ingredients required for the new recipes can be found there."),e._UZ(98,"br"),e._uU(99," 3. For the next week expeditions will require 50% less time to complete. "),e._UZ(100,"br"),e._uU(101," 4. Next update: expedition guardians, new skills and equipment (end of June). "),e.qZA(),e.TgZ(102,"div",6),e.TgZ(103,"p"),e.TgZ(104,"b"),e._uU(105,"15.05.2022 "),e._UZ(106,"br"),e._uU(107,"Technical review."),e.qZA(),e.qZA(),e._uU(108," 1. Combat system rework - the impact of attributes on the base stats has been changed, rebalanced skills, buffed magic."),e._UZ(109,"br"),e._uU(110," 2. Updated experience and stamina system - gained/lost experience is changing exponentially, stamina consumption is more constant."),e._UZ(111,"br"),e._uU(112," 3. Dragon's battle statistics can now be displayed in My Dragon's section."),e._UZ(113,"br"),e._uU(114," 4. For the next week, skill reset and nature change offered by Dragon Tamer will be 10x cheaper. "),e._UZ(115,"br"),e._uU(116," 5. Next update: alchemy - extracts, boosters (end of May). "),e.qZA(),e.TgZ(117,"div",6),e.TgZ(118,"p"),e.TgZ(119,"b"),e._uU(120,"08.05.2022 "),e._UZ(121,"br"),e._uU(122,"Update - Mirage Islands."),e.qZA(),e.qZA(),e._uU(123," 1. A new expedition location has been discovered! This mysterious place hides the remains of relics from another dimension that the dragon summoner may use in her research."),e._UZ(124,"br"),e._uU(125," 2. Added 18 new skills including active skills that require mana and skills for another natures. Some of the existing skills were rebalanced."),e._UZ(126,"br"),e._uU(127," 3. Miracle Fruits were removed from regular expedition loots and will only be available during special events in the future. "),e._UZ(128,"br"),e._uU(129," 4. For the next week expeditions will require 50% less time to complete. "),e._UZ(130,"br"),e._uU(131," 5. Next update: combat system rework (skill multipliers, base attributes, relative strength), battle statistics preview. "),e.qZA(),e.TgZ(132,"div",6),e.TgZ(133,"p"),e.TgZ(134,"b"),e._uU(135,"28.04.2022 "),e._UZ(136,"br"),e._uU(137,"Technical review."),e.qZA(),e.qZA(),e._uU(138," 1. Updated combat experience system, now your dragons can lose experience in battles, and you will only be able to fight the same opponent twice until your dragon rests."),e._UZ(139,"br"),e._uU(140," 2. QoL changes - dragon attributes & feeding hints."),e._UZ(141,"br"),e.qZA(),e.TgZ(142,"div",6),e.TgZ(143,"p"),e.TgZ(144,"b"),e._uU(145,"23.04.2022 "),e._UZ(146,"br"),e._uU(147,"Update - Dragon Tamer."),e.qZA(),e.qZA(),e._uU(148," 1. Dragon Tamer is out - check out his offer."),e._UZ(149,"br"),e._uU(150," 2. Expedition loots rebalance, some items required for Dragon Tamer actions will have a 2x loot chance for the next week."),e._UZ(151,"br"),e._uU(152," 3. Skills rebalance - Sound Body (gradually decreasing effect), Pugnacious Strike (calculated based on dexterity)."),e._UZ(153,"br"),e._uU(154," 4. Minor bug fixes (expedition reports) & display improvements."),e._UZ(155,"br"),e._uU(156," 5. Next update: new dragon skills and special natures"),e._UZ(157,"br"),e.qZA(),e.TgZ(158,"div",6),e.TgZ(159,"p"),e.TgZ(160,"b"),e._uU(161,"18.04.2022 "),e._UZ(162,"br"),e._uU(163,"Update - Runes."),e.qZA(),e.qZA(),e._uU(164," 1. Battle Runes introduction."),e._UZ(165,"br"),e._uU(166," 2. Dragon attributes rebalance."),e._UZ(167,"br"),e._uU(168," 3. Extra: for the next 48 hours expedition will take 50% less time."),e._UZ(169,"br"),e._uU(170," 4. Next update: new dragon skills (& skills rebalance) and special natures. "),e.qZA(),e.TgZ(171,"div",6),e.TgZ(172,"p"),e.TgZ(173,"b"),e._uU(174,"13.04.2022 "),e._UZ(175,"br"),e._uU(176,"Technical review."),e.qZA(),e.qZA(),e._uU(177," 1. New experience formula, experience gained to this point was normalized."),e._UZ(178,"br"),e._uU(179," 2. QoL changes - expedition timers, expedition report mails."),e._UZ(180,"br"),e._uU(181," 3. Minor display fixes."),e._UZ(182,"br"),e._uU(183," 4. Expedition time is back to normal. "),e._UZ(184,"br"),e._uU(185," 5. Next update: full rune implementation. "),e.qZA(),e.TgZ(186,"div",6),e.TgZ(187,"p"),e.TgZ(188,"b"),e._uU(189,"10.04.2022 "),e._UZ(190,"br"),e._uU(191,"Technical review."),e.qZA(),e.qZA(),e._uU(192," 1. New loots added to existing expeditions."),e._UZ(193,"br"),e._uU(194," 2. New game mechanic - rune crafting (for now runes do not have any statistics which will be introduced in a future update). "),e._UZ(195,"br"),e._uU(196," 3. For the next 2 days the expedition time will be cut in half."),e._UZ(197,"br"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(198,"div",8),e.TgZ(199,"div",4),e._uU(200),e.ALo(201,"translate"),e.qZA(),e.YNc(202,bt,2,0,"div",9),e.TgZ(203,"div",10),e.YNc(204,yt,5,16,"div",11),e.ALo(205,"async"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Oqu(e.lcZ(6,4,"game.recentChanges")),e.xp6(195),e.Oqu(e.lcZ(201,6,"game.bestDragons")),e.xp6(2),e.Q6J("ngIf",i.dragonsLoading),e.xp6(2),e.Q6J("ngForOf",e.lcZ(205,8,i.dragons$)))},directives:[h.g,c.O5,x.Q,c.sg,c.PC,c.mk],pipes:[u.X$,c.Ov,Ct.H],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-content[_ngcontent-%COMP%]{display:grid;grid-gap:10px;gap:10px;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));padding:10px}.wrapper-news[_ngcontent-%COMP%]{height:clamp(0px,60vh,600px);overflow:auto}.title[_ngcontent-%COMP%]{margin-bottom:1rem}.item-news[_ngcontent-%COMP%]{margin-top:10px;text-align:left;box-shadow:inset 1px 1px 12px 1px #242936;background-color:#24293666;padding:10px;font-style:italic;letter-spacing:.8px}.item-news[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px;padding-right:10px;float:left}.item-news[_ngcontent-%COMP%]:first-of-type{margin-top:0}.item-dragon[_ngcontent-%COMP%]{margin-bottom:4px;padding:4px;box-shadow:inset 1px 1px 12px 1px #c5a45f;background-color:#c5a45f0d;letter-spacing:1px}.item-dragon[_ngcontent-%COMP%]:hover{box-shadow:inset 1px 1px 12px 1px #d3b984}.item-dragon[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.item-dragon[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#fff;text-decoration:underline}.dragon-first[_ngcontent-%COMP%]{box-shadow:inset 1px 1px 12px 1px #17a2b8;background-color:#17a2b80d}.dragon-first[_ngcontent-%COMP%]:hover{box-shadow:inset 1px 1px 12px 1px #1fc8e3}@media screen and (max-width: 990px){.wrapper-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px 0px;padding:10px}}"],changeDetection:0}),n})();function Ot(n,a){1&n&&(e.TgZ(0,"div",6),e._UZ(1,"app-loading-indicator"),e.qZA())}function Ut(n,a){if(1&n&&(e.TgZ(0,"div",9),e._UZ(1,"app-item-display",10),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("item",t)}}function Pt(n,a){if(1&n&&(e.TgZ(0,"div",7),e.YNc(1,Ut,2,1,"div",8),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}let qt=(()=>{class n{constructor(t,i,o){this.itemController=t,this.engineSerivce=i,this.itemsService=o,this.gold=0,this.ownedItems$=new A.y}ngOnInit(){this.getOwnedItems(),this.gold=this.engineSerivce.user.gold}getOwnedItems(){this.ownedItems$=this.itemController.getOwnedItems().pipe((0,g.U)(t=>t.data.map(i=>this.itemsService.toDisplayItem(i))))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.l3),e.Y36(M.S),e.Y36(L.L))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-inventory"]],decls:10,vars:8,consts:[[1,"wrapper-main"],["currentLocation","inventory"],[1,"wrapper-content"],[1,"label-gold"],["itemsLoading",""],["class","wrapper-items",4,"ngIf","ngIfElse"],[2,"margin-top","50px"],[1,"wrapper-items"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[2,"width","55px","height","55px",3,"item"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.YNc(6,Ot,2,0,"ng-template",null,4,e.W1O),e.YNc(8,Pt,2,1,"div",5),e.ALo(9,"async"),e.qZA(),e.qZA()),2&t){const o=e.MAs(7);e.xp6(4),e.AsE(" ",e.lcZ(5,4,"inventory.gold"),": ",i.gold," "),e.xp6(4),e.Q6J("ngIf",e.lcZ(9,6,i.ownedItems$))("ngIfElse",o)}},directives:[h.g,x.Q,c.O5,c.sg,F.s],pipes:[u.X$,c.Ov],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-content[_ngcontent-%COMP%]{overflow-x:visible}.wrapper-items[_ngcontent-%COMP%]{margin:10px 1rem;display:grid;grid-gap:2px;gap:2px;grid-template-columns:repeat(auto-fit,56px);grid-template-rows:repeat(auto-fit,56px);justify-content:left}.label-gold[_ngcontent-%COMP%]{margin:5px 0px 15px 1rem;font-size:18px;text-align:left;letter-spacing:.7px;color:#d3b984}.item[_ngcontent-%COMP%]{width:56px;height:56px;display:flex;border-radius:4px}@media screen and (max-width: 990px){.wrapper-items[_ngcontent-%COMP%]{justify-content:center}}"],changeDetection:0}),n})();var It=s(9009);function Lt(n,a){1&n&&(e.TgZ(0,"div",8),e._UZ(1,"app-loading-indicator"),e.qZA())}function St(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit,r=e.oxw(2);return r.displayComposeModal=!0,r.replyName=o.senderName}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mails.reply")," "))}function Nt(n,a){if(1&n&&(e.TgZ(0,"div",15),e._UZ(1,"hr"),e._UZ(2,"div",16),e.YNc(3,St,3,3,"div",17),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("innerHTML",t.message.length?t.message:"---",e.oJD),e.xp6(1),e.Q6J("ngIf",t.senderId)}}const Dt=function(n){return{"mail-new":n}};function Et(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",11),e.TgZ(1,"div",12),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).openMail(r)}),e.TgZ(2,"div"),e._uU(3),e.ALo(4,"translate"),e.TgZ(5,"b"),e._uU(6),e.qZA(),e.qZA(),e.TgZ(7,"div"),e._uU(8),e.ALo(9,"translate"),e.TgZ(10,"b"),e._uU(11),e.qZA(),e.qZA(),e.TgZ(12,"div",13),e._uU(13),e.ALo(14,"date"),e.qZA(),e.qZA(),e.YNc(15,Nt,4,2,"div",14),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(14,Dt,!t.isRead)),e.xp6(2),e.hij("",e.lcZ(4,7,"mails.sender"),": "),e.xp6(3),e.Oqu(t.senderName),e.xp6(2),e.hij("",e.lcZ(9,9,"mails.topic"),": "),e.xp6(3),e.Oqu(t.topic),e.xp6(2),e.Oqu(e.xi3(14,11,t.sentDate,"short")),e.xp6(2),e.Q6J("ngIf",t.id===i.activeMailId)}}function kt(n,a){if(1&n&&(e.TgZ(0,"div",9),e.YNc(1,Et,16,16,"div",10),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}function $t(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",19),e.TgZ(1,"button",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().getMails(!1)}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().getMails(!0)}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.canGetPrev),e.xp6(1),e.hij(" ",e.lcZ(3,4,"common.prev")," "),e.xp6(2),e.Q6J("disabled",!t.canGetNext),e.xp6(1),e.hij(" ",e.lcZ(6,6,"common.next")," ")}}function Jt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-mail-send-modal",21),e.NdJ("close",function(){return e.CHM(t),e.oxw().displayComposeModal=!1}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("replyName",t.replyName)}}let Ft=(()=>{class n{constructor(t){this.mailController=t,this.currentPage=0,this.pageLimit=8,this.canGetNext=!1,this.canGetPrev=!1,this.activeMailId=null,this.displayComposeModal=!1,this.replyName=null}ngOnInit(){this.getMails(),this.canGetNext=!0,this.canGetPrev=!0}getMails(t){!0===t&&(this.currentPage+=1),!1===t&&(this.currentPage-=1),this.mails$=this.mailController.getAll({limit:this.pageLimit,page:this.currentPage}).pipe((0,v.b)(o=>{this.canGetPrev=0!==this.currentPage,this.canGetNext=(this.currentPage+1)*this.pageLimit<=o.meta.totalItems-1}),(0,g.U)(o=>o.data))}openMail(t){this.activeMailId=this.activeMailId!==t.id?t.id:null,!1===t.isRead&&this.mailController.read(t.id.toString()).subscribe(),t.isRead=!0}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.vE))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-mail"]],decls:12,vars:9,consts:[[1,"wrapper-main"],["currentLocation","mail"],[1,"wrapper-content"],["mailsLoading",""],["class","wrapper-mails",4,"ngIf","ngIfElse"],["class","wrapper-menu",4,"ngIf"],[1,"btn-base","btn-send",3,"click"],[3,"replyName","close",4,"ngIf"],[2,"margin","162px auto"],[1,"wrapper-mails"],["class","item-mail",4,"ngFor","ngForOf"],[1,"item-mail"],[1,"mail-meta",3,"ngClass","click"],[1,"no-mobile"],["class","mail-content",4,"ngIf"],[1,"mail-content"],[3,"innerHTML"],["class","btn-base btn-mail",3,"click",4,"ngIf"],[1,"btn-base","btn-mail",3,"click"],[1,"wrapper-menu"],[1,"btn-base","btn-mode",3,"disabled","click"],[3,"replyName","close"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.YNc(3,Lt,2,0,"ng-template",null,3,e.W1O),e.YNc(5,kt,2,1,"div",4),e.ALo(6,"async"),e.YNc(7,$t,7,8,"div",5),e.TgZ(8,"div",6),e.NdJ("click",function(){return i.displayComposeModal=!0,i.replyName=null}),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.qZA(),e.qZA(),e.YNc(11,Jt,1,1,"app-mail-send-modal",7)),2&t){const o=e.MAs(4);e.xp6(5),e.Q6J("ngIf",e.lcZ(6,5,i.mails$))("ngIfElse",o),e.xp6(2),e.Q6J("ngIf",i.canGetPrev||i.canGetNext),e.xp6(2),e.hij(" ",e.lcZ(10,7,"mails.compose")," "),e.xp6(2),e.Q6J("ngIf",i.displayComposeModal)}},directives:[h.g,x.Q,c.O5,c.sg,c.mk,It.B],pipes:[c.Ov,u.X$,c.uU],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}hr[_ngcontent-%COMP%]{margin:0 auto 8px;border-top:1px solid #FFEECA;border-radius:8px}.item-mail[_ngcontent-%COMP%]{box-shadow:inset 1px 1px 6px 1px #ffde97;background-color:#ffde970d;width:clamp(0px,95%,600px);margin:8px auto}.item-mail[_ngcontent-%COMP%]   .mail-new[_ngcontent-%COMP%]{box-shadow:inset 1px 1px 8px 1px #17a2b8;background-color:#17a2b80d}.item-mail[_ngcontent-%COMP%]   .mail-meta[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));text-align:left;padding:8px 8px 4px 12px;white-space:nowrap}.item-mail[_ngcontent-%COMP%]   .mail-meta[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden}.item-mail[_ngcontent-%COMP%]   .mail-meta[_ngcontent-%COMP%]:hover{cursor:pointer}.item-mail[_ngcontent-%COMP%]   .mail-content[_ngcontent-%COMP%]{display:block;padding:8px 8px 8px 12px;text-align:left}.item-mail[_ngcontent-%COMP%]   .btn-mail[_ngcontent-%COMP%]{height:24px;margin:8px auto;display:flex;justify-content:center;line-height:24px}.btn-send[_ngcontent-%COMP%]{width:clamp(0px,95%,600px);margin:20px auto}.wrapper-menu[_ngcontent-%COMP%]{width:clamp(0px,95%,600px);margin:8px auto;display:flex;gap:2px}.wrapper-menu[_ngcontent-%COMP%]   .btn-mode[_ngcontent-%COMP%]{width:50%;height:25px;margin:0 auto;line-height:22px;border-radius:2px}"],changeDetection:0}),n})();var Qt=s(1086),Yt=s(7221),Ht=s(4609);function jt(n,a){1&n&&(e.TgZ(0,"div",5),e._UZ(1,"app-loading-indicator"),e.qZA())}function Gt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"app-dragon-card",9),e.NdJ("release",function(o){return e.CHM(t),e.oxw(2).release(o)}),e.qZA(),e.qZA()}if(2&n){const t=a.$implicit;e.xp6(1),e.Q6J("dragon",t)}}function Rt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",10),e.TgZ(1,"div",11),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).navigateAdopt()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA()}2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"dragon.noOwnedDragons")),e.xp6(3),e.hij(" ",e.lcZ(6,4,"dragon.adoptFirstDragon")," "))}function Bt(n,a){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,Gt,2,1,"div",7),e.YNc(2,Rt,7,6,"div",8),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t.ownedDragons),e.xp6(1),e.Q6J("ngIf",t.ownedDragons&&0===t.ownedDragons.length)}}const Wt=function(n,a){return{ownedDragons:n,releaseDragon:a}};let Xt=(()=>{class n{constructor(t,i,o,r){this.router=t,this.actionController=i,this.dragonController=o,this.toastService=r,this.dragonsLoading$=new y.X(!1)}ngOnInit(){this.getOwnedDragons()}getOwnedDragons(){this.dragonsLoading$.next(!0),this.ownedDragons$=this.dragonController.getOwned().pipe((0,v.b)(()=>this.dragonsLoading$.next(!1)))}navigateAdopt(){this.router.navigate(["game","adopt-dragon"])}release(t){this.dragonsLoading$.next(!0),this.ownedDragons$=void 0,this.releaseDragon$=this.actionController.releaseDragon(t.toString()).pipe((0,v.b)(()=>{this.getOwnedDragons(),this.toastService.showSuccess("common.success","dragon.dragonReleased")}),(0,Yt.K)(()=>(this.dragonsLoading$.next(!1),(0,Qt.of)(void 0))))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.F0),e.Y36(l.iQ),e.Y36(l.GE),e.Y36(Z.k))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-my-dragons"]],decls:8,vars:11,consts:[[1,"wrapper-main"],["currentLocation","my-dragons"],[1,"wrapper-content"],["style","margin-top: 50px;",4,"ngIf"],["class","wrapper-dragons",4,"ngIf"],[2,"margin-top","50px"],[1,"wrapper-dragons"],[4,"ngFor","ngForOf"],["class","wrapper-adopt",4,"ngIf"],[3,"dragon","release"],[1,"wrapper-adopt"],[1,"title"],[1,"btn-base","btn-adopt",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.YNc(3,jt,2,0,"div",3),e.ALo(4,"async"),e.YNc(5,Bt,3,2,"div",4),e.ALo(6,"async"),e.ALo(7,"async"),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",e.lcZ(4,2,i.dragonsLoading$)),e.xp6(2),e.Q6J("ngIf",e.WLB(8,Wt,e.lcZ(6,4,i.ownedDragons$),e.lcZ(7,6,i.releaseDragon$))))},directives:[h.g,c.O5,x.Q,c.sg,Ht.B],pipes:[c.Ov,u.X$],styles:[".wrapper-content[_ngcontent-%COMP%]{padding-top:0}.btn-adopt[_ngcontent-%COMP%]{margin-top:25px}"],changeDetection:0}),n})();var Y=s(7739),C=(()=>{return(n=C||(C={})).Error="Error",n.General="General",n.OffTopic="OffTopic",C;var n})(),zt=s(5898),Kt=s(2340);let Vt=(()=>{class n extends zt.sk{constructor(t){const i=t.getAccessToken();super({url:Kt.N.apiUrl,options:{transportOptions:{polling:{extraHeaders:{Authorization:i}}}}})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(I.b))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),en=(()=>{class n{constructor(t){this.socket=t}sendMessage(t,i){this.socket.emit(t,i)}getMessages(t){return this.socket.connect(),this.socket.fromEvent(t)}disconnect(){this.socket.disconnect()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Vt))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var tn=s(8832);const nn=["messagesWrapper"];function on(n,a){1&n&&(e.TgZ(0,"div",12),e._UZ(1,"app-loading-indicator"),e.qZA())}function an(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit,r=e.oxw(2);return r.openPenaltyModal(o,r.PenaltyType.Ban)}),e._UZ(1,"img",21),e._uU(2," | "),e.qZA()}}function rn(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit,r=e.oxw(2);return r.openPenaltyModal(o,r.PenaltyType.Mute)}),e._UZ(1,"img",22),e._uU(2," | "),e.qZA()}}const sn=function(n){return{"message-own":n}};function cn(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",17),e.YNc(1,an,3,0,"div",18),e.YNc(2,rn,3,0,"div",18),e.TgZ(3,"a",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).showUserDetails(o.userId)}),e._uU(4),e.qZA(),e._uU(5),e.ALo(6,"date"),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Gre("item-message message-",t.userRole,""),e.Q6J("ngClass",e.VKq(12,sn,t.nickname===i.user.nickname)),e.xp6(1),e.Q6J("ngIf",i.canBan(t)),e.xp6(1),e.Q6J("ngIf",i.canMute(t)),e.xp6(2),e.Oqu(t.nickname),e.xp6(1),e.AsE(" (",e.xi3(6,9,t.date,"hh:mm"),") | ",t.data," ")}}function ln(n,a){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,cn,7,14,"div",16),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.mode===i.chatMode)}}function pn(n,a){if(1&n&&(e.TgZ(0,"div",13,14),e.YNc(2,ln,2,1,"div",15),e.qZA()),2&n){const t=a.ngIf;e.xp6(2),e.Q6J("ngForOf",t)}}function dn(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-shoutbox-penalty-modal",23),e.NdJ("penaltyInfo",function(o){return e.CHM(t),e.oxw().notifyPenaltyInfo(o)})("close",function(){return e.CHM(t),e.oxw().displayPenaltyModal=!1}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("message",t.penaltyMessage)("penaltyType",t.penaltyType)}}let gn=(()=>{class n{constructor(t,i,o,r,p){this.router=t,this.translateService=i,this.chatService=o,this.repositoryService=r,this.validatorService=p,this.message="",this.tempMessages=[],this.savedMessages=[],this.chatMode=C.General,this.displayPenaltyModal=!1,this.PenaltyType=l.Co}get ChatMode(){return C}ngOnInit(){this.user=this.repositoryService.getUserData(),this.initializeChat()}initializeChat(){this.messages$=this.chatService.getMessages(C.General).pipe((0,v.b)(t=>{this.tempMessages=t}),(0,g.U)(t=>[...this.savedMessages,...t]),(0,v.b)(()=>{(0,Y.H)().subscribe(()=>{this.messagesWrapper&&(this.messagesWrapper.nativeElement.scrollTop=this.messagesWrapper.nativeElement.scrollHeight)}),this.savedMessages.push(...this.tempMessages)}))}changeMode(t){this.chatMode=t,(0,Y.H)(0).subscribe(()=>{this.messagesWrapper&&(this.messagesWrapper.nativeElement.scrollTop=this.messagesWrapper.nativeElement.scrollHeight)})}sendMessage(){if(this.message.length<d.lY||this.message.length>d.gc||!this.validatorService.checkBannedWords(this.message,!0))return;const t={date:Date.now(),userId:this.user.id,userRole:this.user.role,nickname:this.user.nickname,data:this.message,mode:this.chatMode};this.chatService.sendMessage(C.General,t),this.message=""}canMute(t){return t.userRole!==l.i4.Administrator&&t.userId!==this.user.id&&(this.user.role===l.i4.Moderator||this.user.role===l.i4.Administrator)}canBan(t){return t.userId!==this.user.id&&this.user.role===l.i4.Administrator}openPenaltyModal(t,i){this.penaltyMessage=t,this.penaltyType=i,this.displayPenaltyModal=!0}notifyPenaltyInfo(t){this.displayPenaltyModal=!1;const o=this.translateService.instant(t.type===l.Co.Ban?"shoutbox.banInfo":"shoutbox.muteInfo",{nickname:t.punishedNickname,duration:t.duration}),r={date:Date.now(),userId:this.user.id,userRole:this.user.role,nickname:this.user.nickname,data:o,mode:this.chatMode};this.chatService.sendMessage(C.General,r)}showUserDetails(t){this.router.navigate(["game","profile",t])}ngOnDestroy(){this.chatService.disconnect()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(f.F0),e.Y36(u.sK),e.Y36(en),e.Y36(I.b),e.Y36(q.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-shoutbox"]],viewQuery:function(t,i){if(1&t&&e.Gf(nn,5),2&t){let o;e.iGM(o=e.CRH())&&(i.messagesWrapper=o.first)}},decls:21,vars:15,consts:[[1,"wrapper-main"],["currentLocation","shoutbox"],[1,"wrapper-content"],[1,"wrapper-chat"],[1,"wrapper-topics"],[1,"btn-base","btn-chat-topic",3,"click"],["messagesLoading",""],["class","wrapper-messages",4,"ngIf","ngIfElse"],[1,"wrapper-form"],["type","text",1,"input-chat",3,"ngModel","ngModelChange"],[1,"btn-base","btn-send",3,"click"],[3,"message","penaltyType","penaltyInfo","close",4,"ngIf"],[2,"margin","50px auto"],[1,"wrapper-messages"],["messagesWrapper",""],[4,"ngFor","ngForOf"],[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["class","item-ban",3,"click",4,"ngIf"],[3,"click"],[1,"item-ban",3,"click"],["src","assets/img/icons/ban-user.svg","alt","ban"],["src","assets/img/icons/mute-user.svg","alt","mute"],[3,"message","penaltyType","penaltyInfo","close"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.NdJ("click",function(){return i.changeMode(i.ChatMode.General)}),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",5),e.NdJ("click",function(){return i.changeMode(i.ChatMode.OffTopic)}),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.qZA(),e.YNc(11,on,2,0,"ng-template",null,6,e.W1O),e.YNc(13,pn,3,1,"div",7),e.ALo(14,"async"),e.TgZ(15,"div",8),e.TgZ(16,"input",9),e.NdJ("ngModelChange",function(r){return i.message=r}),e.qZA(),e.TgZ(17,"div",10),e.NdJ("click",function(){return i.sendMessage()}),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(20,dn,1,2,"app-shoutbox-penalty-modal",11)),2&t){const o=e.MAs(12);e.xp6(6),e.hij(" ",e.lcZ(7,7,"shoutbox.general")," "),e.xp6(3),e.hij(" ",e.lcZ(10,9,"shoutbox.offtopic")," "),e.xp6(4),e.Q6J("ngIf",e.lcZ(14,11,i.messages$))("ngIfElse",o),e.xp6(3),e.Q6J("ngModel",i.message),e.xp6(2),e.hij(" ",e.lcZ(19,13,"shoutbox.send")," "),e.xp6(2),e.Q6J("ngIf",i.displayPenaltyModal)}},directives:[h.g,x.Q,c.O5,c.sg,c.mk,_.Fj,_.JJ,_.On,tn.g],pipes:[u.X$,c.Ov,c.uU],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-chat[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.wrapper-topics[_ngcontent-%COMP%]{width:clamp(0px,95%,800px);margin:auto;display:flex;gap:1px}.btn-chat-topic[_ngcontent-%COMP%]{width:50%;line-height:2}.btn-chat-topic[_ngcontent-%COMP%]:first-of-type{border-radius:6px 0 0 2px}.btn-chat-topic[_ngcontent-%COMP%]:last-of-type{border-radius:0 6px 2px 0}.wrapper-messages[_ngcontent-%COMP%]{width:clamp(0px,95%,800px);height:600px;margin:auto;overflow-y:auto;padding:4px 2px;background:#242936;border-radius:2px}.item-message[_ngcontent-%COMP%]{width:100%;margin:-2px auto;padding-left:4px;display:inline-block;letter-spacing:.5px;text-align:left;overflow:hidden;background:#2c3242}.item-message[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;font-weight:600}.item-message[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.message-own[_ngcontent-%COMP%]{background:#343c4e}.message-Moderator[_ngcontent-%COMP%]{color:#d5ff80}.message-Administrator[_ngcontent-%COMP%]{color:#ff544c}.item-ban[_ngcontent-%COMP%]{margin-top:0%;display:inline;cursor:pointer}.item-ban[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:inline-block;max-height:100%;height:16px}.wrapper-form[_ngcontent-%COMP%]{width:clamp(0px,95%,800px);margin:auto;display:flex;padding-top:0;padding-bottom:8px}.input-chat[_ngcontent-%COMP%]{width:calc(70% - 2px);height:30px;margin:0 2px 0 0;padding:4px;display:inline-block;border:none;border-radius:2px 0 0 6px}.btn-send[_ngcontent-%COMP%]{width:30%;margin-top:0;padding:0;line-height:30px;display:inline-block;border-radius:0 2px 6px 0}@media screen and (max-width: 990px){.wrapper-messages[_ngcontent-%COMP%]{max-height:60vh}.wrapper-form[_ngcontent-%COMP%]{display:block}.input-chat[_ngcontent-%COMP%]{width:100%;margin:0;border-radius:2px}.btn-send[_ngcontent-%COMP%]{min-width:100%;margin:20px 0 0;padding:0;border-radius:2px 2px 6px 6px}}"],changeDetection:0}),n})();var O=s(567),U=s(1709),mn=s(1590),_n=s(4944),un=s(5173),hn=s(1697);function xn(n,a){if(1&n&&(e.TgZ(0,"div"),e.TgZ(1,"div",9),e._UZ(2,"img",10),e.qZA(),e.qZA()),2&n){const t=a.ngIf;e.xp6(2),e.Q6J("src",t,e.LSH)}}function fn(n,a){1&n&&(e.TgZ(0,"div",9),e._UZ(1,"img",11),e.qZA())}function vn(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"input",12,13),e.NdJ("change",function(o){return e.CHM(t),e.oxw(2).setAvatar(o)}),e.qZA(),e.TgZ(3,"div",14),e.NdJ("click",function(){return e.CHM(t),e.MAs(2).click()}),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.qZA()}2&n&&(e.xp6(4),e.hij(" ",e.lcZ(5,1,"user.setAvatar")," "))}function Zn(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().ngIf;return e.oxw().requestFriend(o.id)}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.qZA()}2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"user.inviteFriend")," "))}function Cn(n,a){if(1&n&&(e.TgZ(0,"div",19),e.TgZ(1,"h3"),e._uU(2),e.qZA(),e._UZ(3,"img",20),e.TgZ(4,"p"),e._uU(5),e.ALo(6,"translate"),e._UZ(7,"br"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("src",t.image,e.LSH)("alt",t.name),e.xp6(2),e.AsE(" ",e.lcZ(6,7,"dragon.nature"),": ",t.nature," "),e.xp6(3),e.AsE(" ",e.lcZ(9,9,"dragon.experience"),": ",t.experience," ")}}function bn(n,a){if(1&n&&(e.TgZ(0,"div",16),e.TgZ(1,"div",17),e._uU(2),e.TgZ(3,"b"),e._uU(4),e.qZA(),e._uU(5),e.YNc(6,Cn,10,11,"ng-template",null,18,e.W1O),e.qZA(),e.qZA()),2&n){const t=a.$implicit,i=a.index;e.xp6(2),e.hij(" ",i+1,". "),e.xp6(2),e.Oqu(t.name),e.xp6(1),e.hij(" [",t.level,"] ")}}function An(n,a){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,bn,8,3,"div",15),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}function wn(n,a){if(1&n&&(e.TgZ(0,"div",24),e.TgZ(1,"h3"),e._uU(2),e.qZA(),e.TgZ(3,"p"),e._uU(4),e.qZA(),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.hint)}}function Tn(n,a){if(1&n&&(e.TgZ(0,"div",17),e._UZ(1,"img",20),e.YNc(2,wn,5,2,"ng-template",null,18,e.W1O),e.qZA()),2&n){const t=e.oxw().$implicit;e.Gre("item-achievement ",t.cssClass,""),e.xp6(1),e.Q6J("src",t.image,e.LSH)("alt",t.name)}}function yn(n,a){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Tn,4,5,"div",23),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().ngIf,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",i.user&&o.checkCompleted(t,i.user))}}function Mn(n,a){if(1&n&&(e.TgZ(0,"div",21),e.YNc(1,yn,2,1,"div",22),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t.all)}}function On(n,a){if(1&n&&(e.TgZ(0,"div"),e.TgZ(1,"div",28),e._UZ(2,"img",10),e.qZA(),e.qZA()),2&n){const t=a.ngIf;e.xp6(2),e.Q6J("src",t,e.LSH)}}function Un(n,a){1&n&&(e.TgZ(0,"div",28),e._UZ(1,"img",11),e.qZA())}function Pn(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",27),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).showFriendDetails(r.id)}),e.YNc(1,On,3,1,"div",4),e.YNc(2,Un,2,0,"ng-template",null,5,e.W1O),e._uU(4),e.qZA()}if(2&n){const t=a.$implicit,i=e.MAs(3);e.xp6(1),e.Q6J("ngIf",t.avatar)("ngIfElse",i),e.xp6(3),e.hij(" ",t.nickname," ")}}function qn(n,a){if(1&n&&(e.TgZ(0,"div",25),e.YNc(1,Pn,5,3,"div",26),e.qZA()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngForOf",t)}}function In(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"app-user-friend-requests",30),e.NdJ("close",function(){return e.CHM(t),e.oxw(3).displayFriendInvitations=!1})("friendshipAccepted",function(o){return e.CHM(t),e.oxw(3).updateFriends(o)}),e.qZA()}if(2&n){const t=e.oxw().ngIf;e.Q6J("friendInvitations",t)}}function Ln(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",14),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).displayFriendInvitations=!0}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,In,1,1,"app-user-friend-requests",29),e.qZA()}if(2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",e.lcZ(3,2,"user.seeInvitations")," "),e.xp6(2),e.Q6J("ngIf",t.displayFriendInvitations)}}const Sn=function(n,a){return{all:n,user:a}};function Nn(n,a){if(1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"h2"),e._uU(2),e.qZA(),e.TgZ(3,"h2"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.YNc(6,xn,3,1,"div",4),e.ALo(7,"async"),e.YNc(8,fn,2,0,"ng-template",null,5,e.W1O),e.YNc(10,vn,6,3,"div",6),e.YNc(11,Zn,4,3,"div",6),e._UZ(12,"hr"),e.TgZ(13,"h2"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.YNc(16,An,2,1,"div",6),e.ALo(17,"async"),e._UZ(18,"hr"),e.TgZ(19,"h2"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.YNc(22,Mn,2,1,"div",7),e.ALo(23,"async"),e.ALo(24,"async"),e._UZ(25,"hr"),e.TgZ(26,"h2"),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.YNc(29,qn,2,1,"div",8),e.ALo(30,"async"),e.YNc(31,Ln,5,4,"div",6),e.ALo(32,"async"),e.qZA()),2&n){const t=a.ngIf,i=e.MAs(9),o=e.oxw();e.xp6(2),e.AsE("",t.nickname," [",t.role,"]"),e.xp6(2),e.AsE(" ",e.lcZ(5,15,"inventory.gold"),": ",t.gold,""),e.xp6(2),e.Q6J("ngIf",e.lcZ(7,17,o.avatar$))("ngIfElse",i),e.xp6(4),e.Q6J("ngIf",o.ownProfile),e.xp6(1),e.Q6J("ngIf",!o.ownProfile),e.xp6(3),e.Oqu(e.lcZ(15,19,"user.dragons")),e.xp6(2),e.Q6J("ngIf",e.lcZ(17,21,o.dragons$)),e.xp6(4),e.Oqu(e.lcZ(21,23,"user.achievements")),e.xp6(2),e.Q6J("ngIf",e.WLB(35,Sn,e.lcZ(23,25,o.allAchievements$),e.lcZ(24,27,o.userAchievements$))),e.xp6(5),e.Oqu(e.lcZ(28,29,"user.friends")),e.xp6(2),e.Q6J("ngIf",e.lcZ(30,31,o.friends$)),e.xp6(2),e.Q6J("ngIf",o.ownProfile&&e.lcZ(32,33,o.friendInvitations$))}}let H=(()=>{class n{constructor(t,i,o,r,p,m,w,P,S,b,N){this.cdRef=t,this.route=i,this.router=o,this.achievementsController=r,this.dragonController=p,this.userController=m,this.userControllerHelper=w,this.engineService=P,this.dragonService=S,this.itemService=b,this.toastService=N,this.ownProfile=!1,this.displayFriendInvitations=!1}ngOnInit(){this.route.paramMap.subscribe(t=>{const i=this.engineService.user.id,o=t.get("id");o&&i!==+o?this.getOtherUserData(o):(this.ownProfile=!0,this.getUserData())}),this.allAchievements$=this.achievementsController.getAllAchievements().pipe((0,g.U)(t=>t.map(i=>this.itemService.toDisplayAchievement(i))))}getUserData(){this.user$=this.engineService.getUser(),this.avatar$=this.userControllerHelper.getAvatar(),this.userAchievements$=this.achievementsController.getUserAchievements(),this.friends$=this.userController.getFriends().pipe((0,U.zg)(t=>(0,O.D)(t.map(i=>this.userControllerHelper.getAvatarPublic(i.id).pipe((0,g.U)(o=>Object.assign(Object.assign({},i),{avatar:o}))))))),this.friendInvitations$=this.userController.getPendingFriendshipRequests().pipe((0,U.zg)(t=>(0,O.D)(t.map(i=>this.userControllerHelper.getAvatarPublic(i.requesterId).pipe((0,g.U)(o=>Object.assign(Object.assign({},i),{avatar:o}))))))),this.dragons$=this.dragonController.getOwned().pipe((0,g.U)(t=>t.map(i=>this.dragonService.toDisplayDragon(i))))}getOtherUserData(t){this.user$=this.userController.getPublicData(t),this.avatar$=this.userControllerHelper.getAvatarPublic(t),this.userAchievements$=this.achievementsController.getUserPublicAchievements(t),this.friends$=this.userController.getFriendsPublic(t).pipe((0,U.zg)(i=>(0,O.D)(i.map(o=>this.userControllerHelper.getAvatarPublic(o.id).pipe((0,g.U)(r=>Object.assign(Object.assign({},o),{avatar:r}))))))),this.dragons$=this.dragonController.getPublicPlayerDragons(t).pipe((0,g.U)(i=>i.map(o=>this.dragonService.toDisplayDragonPublic(o))))}requestFriend(t){this.userController.requestFriendship({targetUserId:t}).subscribe(()=>{this.toastService.showSuccess("common.success","user.friendInvitationSent")})}updateFriends(t){this.displayFriendInvitations=!1,this.friendInvitations$=this.userController.getPendingFriendshipRequests().pipe((0,U.zg)(i=>(0,O.D)(i.map(o=>this.userControllerHelper.getAvatarPublic(o.requesterId).pipe((0,g.U)(r=>Object.assign(Object.assign({},o),{avatar:r}))))))),t?(this.toastService.showSuccess("common.success","user.requestAccepted"),this.friends$=this.userController.getFriends().pipe((0,U.zg)(i=>(0,O.D)(i.map(o=>this.userControllerHelper.getAvatarPublic(o.id).pipe((0,g.U)(r=>Object.assign(Object.assign({},o),{avatar:r})))))))):this.toastService.showSuccess("common.success","user.requestDeclined")}setAvatar(t){!t.target.files[0]||this.userControllerHelper.setAvatar(t.target.files[0]).subscribe(()=>{this.avatar$=this.userControllerHelper.getAvatar(),this.toastService.showSuccess("common.success","user.avatarSet"),this.cdRef.detectChanges()})}showFriendDetails(t){this.router.navigate(["game","profile",t])}checkCompleted(t,i){return i[t.uid]>=t.tier}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(f.gz),e.Y36(f.F0),e.Y36(l.ph),e.Y36(l.GE),e.Y36(l.st),e.Y36(mn.v),e.Y36(M.S),e.Y36(_n.x),e.Y36(L.L),e.Y36(Z.k))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-user-profile"]],decls:4,vars:3,consts:[[1,"wrapper-main"],["currentLocation","profile"],["class","wrapper-content",4,"ngIf"],[1,"wrapper-content"],[4,"ngIf","ngIfElse"],["noAvatar",""],[4,"ngIf"],["class","wrapper-achievements",4,"ngIf"],["class","wrapper-friends",4,"ngIf"],[1,"item-avatar"],["alt","avatar","draggable","false",3,"src"],["src","assets/img/lore/player.png","alt","avatar","draggable","false"],["type","file",1,"gone",3,"change"],["fileUpload",""],[1,"btn-base","btn-avatar",3,"click"],["class","item-dragon",4,"ngFor","ngForOf"],[1,"item-dragon"],["tooltip",""],["tooltipTemplate",""],[1,"item-tooltip","dragon-tooltip"],["draggable","false",3,"src","alt"],[1,"wrapper-achievements"],[4,"ngFor","ngForOf"],["tooltip","",3,"class",4,"ngIf"],[1,"item-tooltip","achievement-tooltip"],[1,"wrapper-friends"],["class","item-friend",3,"click",4,"ngFor","ngForOf"],[1,"item-friend",3,"click"],[1,"item-friend-avatar"],[3,"friendInvitations","close","friendshipAccepted",4,"ngIf"],[3,"friendInvitations","close","friendshipAccepted"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-navigation-bar",1),e.YNc(2,Nn,33,38,"div",2),e.ALo(3,"async"),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,1,i.user$)))},directives:[h.g,c.O5,c.sg,un.i,hn.N],pipes:[c.Ov,u.X$],styles:[".color-Common[_ngcontent-%COMP%]{color:#bbc3c8}.color-Scarce[_ngcontent-%COMP%]{color:#cdc90b}.color-Rare[_ngcontent-%COMP%]{color:#c967eb}.color-Mythical[_ngcontent-%COMP%]{color:#00e1e1}.wrapper-content[_ngcontent-%COMP%]{padding:1rem;text-align:left}.wrapper-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:400;letter-spacing:.5px}.wrapper-content[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{margin:5px 0;border:0;border-top:.5px dashed #FFEECA;opacity:.5}.item-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:200px;width:200px;object-fit:cover}.btn-avatar[_ngcontent-%COMP%]{width:160px;height:18px;margin:10px 0;line-height:16px;text-align:center}.item-dragon[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;letter-spacing:.5px;cursor:help}.dragon-tooltip[_ngcontent-%COMP%]{width:220px;padding:10px 5px 0;text-align:center}.dragon-tooltip[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:120px}.wrapper-achievements[_ngcontent-%COMP%]{padding:6px 0;display:flex;flex-wrap:wrap}.item-achievement[_ngcontent-%COMP%]{width:60px;margin:3px 6px 3px 0}.item-achievement[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%}.achievement-tooltip[_ngcontent-%COMP%]{box-shadow:inset 0 0 2px 1px #000}.achievement-1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid #bbc3c8}.achievement-2[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid #cdc90b}.achievement-3[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid #c967eb}.wrapper-friends[_ngcontent-%COMP%]{display:flex}.item-friend[_ngcontent-%COMP%]{width:60px;margin:3px 6px 3px 0;text-align:center;cursor:pointer}.item-friend-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:60px;width:60px;border:2px solid #FFEECA;border-radius:50%}"],changeDetection:0}),n})();const Dn=[{path:"home",component:Mt},{path:"profile",component:H},{path:"profile/:id",component:H},{path:"adopt-dragon",component:V},{path:"my-dragons",component:Xt},{path:"summon-dragon",component:He},{path:"dragon-tamer",component:ct},{path:"inventory",component:qt},{path:"expeditions",component:Zt},{path:"arena",component:J},{path:"arena/:id",component:J},{path:"auctions",component:Pe},{path:"mail",component:Ft},{path:"shoutbox",component:gn},{path:"crafting",component:ke},{path:"alchemy",component:oe},{path:"**",redirectTo:"home",pathMatch:"full"}];let En=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[f.Bz.forChild(Dn)],f.Bz]}),n})();var kn=s(294);let $n=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[c.ez,_.u5,En,kn.I.forChild()]]}),n})()}}]);